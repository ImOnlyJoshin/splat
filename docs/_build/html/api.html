

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API &mdash; SpeX Prism Library Analysis Toolkit 0.31 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/logo.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="SpeX Prism Library Analysis Toolkit 0.31 documentation" href="index.html"/>
        <link rel="prev" title="Brown Dwarf Evolutionary Models" href="splat_evolve.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SpeX Prism Library Analysis Toolkit
          

          
            
            <img src="_static/logo.jpg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.31
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation and Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat.html">Main SPLAT module</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_plot.html">SPLAT Plotting Routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_model.html">SPLAT Spectral Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_evolve.html">Brown Dwarf Evolutionary Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#splat-classes">SPLAT Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectrum">Spectrum</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#splat-routines">SPLAT Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#database-access">Database Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spectral-comparison">Spectral Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spectral-classification">Spectral Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spectrophotometry">Spectrophotometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-spectral-analyses">Other Spectral Analyses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#empirical-relationships">Empirical Relationships</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-routines">Conversion Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-routines">Plotting Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utility-routines">Utility Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#i-o-routines">I/O Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modeling-routines">Modeling Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectral-modeling-routines">Spectral Modeling Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evolutionary-model-routines">Evolutionary Model Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#specialty-packages">Specialty Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#euclid-analysis-routines">EUCLID Analysis Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bibtex-routines">BibTeX Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#astroquery-based-data-access">Astroquery-based Data Access</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SpeX Prism Library Analysis Toolkit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>API</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/api.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="splat-classes">
<h2>SPLAT Classes<a class="headerlink" href="#splat-classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spectrum">
<h3>Spectrum<a class="headerlink" href="#spectrum" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="splat.Spectrum">
<em class="property">class </em><code class="descclassname">splat.</code><code class="descname">Spectrum</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Primary class for containing spectral and source data for SpeX Prism Library.</td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ismodel</strong> &#8211; Set to True to specify spectrum as a model (default = False)</li>
<li><strong>wlabel</strong> &#8211; label of wavelength (default = &#8216;Wavelength&#8217;)</li>
<li><strong>wunit</strong> &#8211; unit in which wavelength is measured (default = u.micron)</li>
<li><strong>wunit_label</strong> &#8211; label of the unit of wavelength (default = &#8216;micron&#8217;)</li>
<li><strong>flabel</strong> &#8211; label of flux density (default = &#8216;F_lambda&#8217;)</li>
<li><strong>fscale</strong> &#8211; string describing how flux density is scaled (default = &#8216;&#8217;)</li>
<li><strong>funit</strong> &#8211; unit in which flux density is measured (default = u.erg/(u.cm**2 * u.s * u.micron)</li>
<li><strong>funit_label</strong> &#8211; label of the unit of flux density (default = &#8216;erg cm^-2 s^-1 micron^-1&#8217;)</li>
<li><strong>resolution</strong> &#8211; Resolution of spectrum (default = 150)</li>
<li><strong>slitpixelwidth</strong> &#8211; Width of the slit measured in subpixel values (default = 3.33)</li>
<li><strong>slitwidth</strong> &#8211; Actual width of the slit, measured in arcseconds. Default value is the <code class="docutils literal"><span class="pre">slitpixelwidth</span></code> multiplied an assumed (for SpeX) spectrograph pixel scale of 0.15 arcseconds</li>
<li><strong>header</strong> &#8211; header info of the spectrum (default = Table())</li>
<li><strong>filename</strong> &#8211; a string containing the spectrum&#8217;s filename (default = &#8216;&#8217;)</li>
<li><strong>file</strong> &#8211; same as filename (default = &#8216;&#8217;)</li>
<li><strong>idkey</strong> &#8211; spectrum key of the desired spectrum (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;myspectrum.fits&#39;</span><span class="p">)</span>      <span class="c1"># read in a file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;myspectrum.fits&#39;</span><span class="p">)</span>               <span class="c1"># same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10002</span><span class="p">)</span>                           <span class="c1"># read in spectrum with idkey = 10002</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wavearray</span><span class="p">,</span><span class="n">flux</span><span class="o">=</span><span class="n">fluxarray</span><span class="p">)</span>   <span class="c1"># create objects with wavelength &amp; flux arrays</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="splat.Spectrum.brightnessTemperature">
<code class="descname">brightnessTemperature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.brightnessTemperature" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Convert to surface fluxes given a radius, assuming at absolute fluxes</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.computeSN">
<code class="descname">computeSN</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.computeSN" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Compute a representative S/N value as the median value of S/N among the top 50% of flux values</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">the S/N value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">115.96374031163553</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.copy" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Make a copy of a Spectrum object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.export" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Exports a Spectrum object to either a fits or ascii file, depending on file extension given.  If no filename is explicitly given, the Spectrum.filename attribute is used. If the filename does not include the full path, the file is saved in the current directory.  Spectrum.export and <a class="reference external" href="api.html#splat.Spectrum.save">Spectrum.save</a> function in the same manner.</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> (<em>optional, default = Spectrum.simplefilename</em>) &#8211; String specifying the filename to save</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">An ascii or fits file with the data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;/Users/adam/myspectrum.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">ascii</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/Users/adam/myspectrum.txt&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;tab&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go"> &lt;Table length=564&gt;</span>
<span class="go">   wavelength          flux          uncertainty</span>
<span class="go">    float64          float64           float64</span>
<span class="go"> -------------- ----------------- -----------------</span>
<span class="go"> 0.645418405533               0.0               nan</span>
<span class="go"> 0.647664904594 6.71920214475e-16 3.71175052033e-16</span>
<span class="go"> 0.649897933006 1.26009925777e-15 3.85722895842e-16</span>
<span class="go"> 0.652118623257 7.23781818374e-16 3.68178778862e-16</span>
<span class="go"> 0.654327988625 1.94569566622e-15 3.21007116982e-16</span>
<span class="go"> ...</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.fluxCalibrate">
<code class="descname">fluxCalibrate</code><span class="sig-paren">(</span><em>filt</em>, <em>mag</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.fluxCalibrate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Flux calibrates a spectrum given a filter and a magnitude. The filter must be one of those listed in <cite>splat.FILTERS.keys()</cite>. It is possible to specifically set the magnitude to be absolute (by default it is apparent).  This function changes the Spectrum object&#8217;s flux, noise and variance arrays.</td>
</tr>
</tbody>
</table>
<p>Required Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filter</strong> &#8211; string specifiying the name of the filter</li>
<li><strong>mag</strong> &#8211; number specifying the magnitude to scale to</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>absolute</strong> &#8211; set to True to specify that the given magnitude is an absolute magnitude, which sets the <code class="docutils literal"><span class="pre">fscale</span></code> keyword in the Spectrum object to &#8216;Absolute&#8217; (default = False)</li>
<li><strong>apparent</strong> &#8211; set to True to specify that the given magnitude is an apparent magnitude, which sets the <code class="docutils literal"><span class="pre">fscale</span></code> flag in the Spectrum object to &#8216;Apparent&#8217; (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Outputs:</p>
<p>None, Spectrum object is changed to a flux calibrated spectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">filterMag</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go"> (15.002545668628173, 0.017635234089677564)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.fluxMax">
<code class="descname">fluxMax</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.fluxMax" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Reports the maximum flux of a Spectrum object ignoring nan&#8217;s.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>maskTelluric</strong> (<em>optional, default = True</em>) &#8211; masks telluric regions</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">maximum flux (with units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.fluxUnit">
<code class="descname">fluxUnit</code><span class="sig-paren">(</span><em>funit</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.fluxUnit" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts wavelength to microns. This routine changes the underlying Spectrum object.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Angstrom&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toMicron</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;micron&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.info">
<code class="descname">info</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.info" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Returns a summary of properties for the Spectrum object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">Text summary</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"> Spectrum of NLTT 184</span>
<span class="go"> Observed on 20071012</span>
<span class="go"> at an airmass of 1.145</span>
<span class="go"> Full source designation is J00054517+0723423</span>
<span class="go"> Median S/N = 97.0</span>
<span class="go"> SPLAT source key is 10012.0</span>
<span class="go"> SPLAT spectrum key is 10857</span>
<span class="go"> Data published in Kirkpatrick, J. D. et al. (2010, ApJS, 190, 100-146)</span>
<span class="go"> History:</span>
<span class="go">     Spectrum successfully loaded</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.normalize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Normalize a spectrum to a maximum value of 1 (in its current units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>waveRange</strong> (<em>optional, default = None</em>) &#8211; choose the wavelength range to normalize; can be a list specifying minimum and maximum or a single number to normalize around a particular point</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">maximum flux (with units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">waverange</span><span class="o">=</span><span class="p">[</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.591310977935791 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.plot" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">calls the <a href="#id22"><span class="problematic" id="id23">plotSpectrum_</span></a> function, by default showing the noise spectrum and zeropoints. See the <a href="#id24"><span class="problematic" id="id25">plotSpectrum_</span></a> API listing for details.</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">A plot of the Spectrum object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.reset" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Restores a Spectrum to its original read-in state, removing scaling and smoothing. This routine changes the Spectrum object directly and there is no output.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 4.561630292384622e-15 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 0.9999999403953552 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 4.561630292384622e-15 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.rvShift">
<code class="descname">rvShift</code><span class="sig-paren">(</span><em>rv</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.rvShift" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Shifts the wavelength scale by a radial velocity factor. This routine changes the underlying Spectrum object.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Angstrom&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toMicron</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;micron&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.save" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Exports a Spectrum object to either a fits or ascii file, depending on file extension given.  If no filename is explicitly given, the Spectrum.filename attribute is used. If the filename does not include the full path, the file is saved in the current directory.</td>
</tr>
</tbody>
</table>
<p><a class="reference external" href="api.html#splat.Spectrum.export">Spectrum.export()</a> and <cite>Spectrum.save</cite> function in the same manner.</p>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.scale">
<code class="descname">scale</code><span class="sig-paren">(</span><em>factor</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.scale" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Scales a Spectrum object&#8217;s flux and noise values by a constant factor. This routine changes the Spectrum object directly.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>factor</strong> (<em>required, default = None</em>) &#8211; A floating point number used to scale the Spectrum object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">maximum flux (with units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.showHistory">
<code class="descname">showHistory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.showHistory" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Report history of actions taken on a Spectrum object. This can also be retrieved by printing the attribute Spectrum.history</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">List of actions taken on spectrum</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">showHistory</span><span class="p">()</span>
<span class="go"> Spectrum successfully loaded</span>
<span class="go"> Spectrum normalized</span>
<span class="go"> Flux calibrated with 2MASS J filter to an apparent magnitude of 15.0</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.smooth">
<code class="descname">smooth</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.smooth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Smoothes a spectrum either by selecting a constant slit width (smooth in spectral dispersion space), pixel width (smooth in pixel space) or resolution (smooth in velocity space). One of these options must be selected for any smoothing to happen. Changes spectrum directly.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> (<em>optional, default = Hanning</em>) &#8211; the type of smoothing window to use. See <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html">http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html</a> for more details.</li>
<li><strong>resolution</strong> (<em>optional, default = None</em>) &#8211; Constant resolution to smooth toe(see <a class="reference external" href="api.html#splat.Spectrum.smoothToResolution">smoothToResolution</a>)</li>
<li><strong>slitPixelWidth</strong> (<em>optional, default = None</em>) &#8211; Number of pixels to smooth in pixel space (see <a class="reference external" href="api.html#splat.Spectrum.smoothToSlitPixelWidth">smoothToSlitPixelWidth</a>)</li>
<li><strong>slitWidth</strong> (<em>optional, default = None</em>) &#8211; Number of pixels to smooth in angular space (see <a class="reference external" href="api.html#splat.Spectrum.smoothToPixelWidth">smoothToPixelWidth</a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothfluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.surface">
<code class="descname">surface</code><span class="sig-paren">(</span><em>radius</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.surface" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Convert to surface fluxes given a radius, assuming at absolute fluxes</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">UNTESTED, NEED TO ADD IN UNCERTAINTIES</p>
</div>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.toAngstrom">
<code class="descname">toAngstrom</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.toAngstrom" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts wavelength to Angstrom. This routine changes the underlying Spectrum object.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;micron&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toAngstrom</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Angstrom&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.toFlam">
<code class="descname">toFlam</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.toFlam" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts flux density to F_lambda in units of erg/s/cm^2/Hz. This routine changes the underlying Spectrum object. There is no change if the spectrum is already in F_lambda units.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFnu</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Jy&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFlam</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;erg / (cm2 micron s)&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.toFnu">
<code class="descname">toFnu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.toFnu" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts flux density F_nu in units of Jy. This routine changes the underlying Spectrum object. There is no change if the spectrum is already in F_nu units.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFnu</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Jy&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.toMicron">
<code class="descname">toMicron</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.toMicron" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts wavelength to microns. This routine changes the underlying Spectrum object.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Angstrom&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toMicron</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;micron&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.toSED">
<code class="descname">toSED</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.toSED" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts flux density in F_lambda to lambda x F_lambda with units of erg/s/cm^2. This routine changes the underlying Spectrum object.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toSED</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;erg / (cm2 s)&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.trim">
<code class="descname">trim</code><span class="sig-paren">(</span><em>rng</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.trim" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Trims a spectrum to be within a certain wavelength range or set of ranges. Data outside of these ranges are excised from the wave, flux and noise arrays. The full spectrum can be restored with the reset() procedure.</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>range</strong> &#8211; the range(s) over which the spectrum is retained - a series of nested 2-element arrays</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothfluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.waveRange">
<code class="descname">waveRange</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.waveRange" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Return the wavelength range of the current Spectrum object.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">2-element array giving minimum and maximum of wavelength range</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitwidth</span>
<span class="go">[&lt;Quantity 0.6447611451148987 micron&gt;, &lt;Quantity 2.5517737865448 micron&gt;]</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.waveUnit">
<code class="descname">waveUnit</code><span class="sig-paren">(</span><em>wunit</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.waveUnit" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts wavelength to microns. This routine changes the underlying Spectrum object.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wunit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Angstrom&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toMicron</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;micron&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="splat-routines">
<h2>SPLAT Routines<a class="headerlink" href="#splat-routines" title="Permalink to this headline">¶</a></h2>
<div class="section" id="database-access">
<h3>Database Access<a class="headerlink" href="#database-access" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.getSpectrum">
<code class="descclassname">splat.</code><code class="descname">getSpectrum</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.getSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Gets a spectrum from the SPLAT library using various selection criteria. Calls <a class="reference external" href="api.html#splat_db.searchLibrary">searchLibrary</a> to select spectra; if any found it routines an array of Spectrum objects, otherwise an empty array.</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">An array of Spectrum objects that satisfy the search criteria</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Retrieving 1 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sparr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">spt</span><span class="o">=</span><span class="s1">&#39;M7&#39;</span><span class="p">)</span>
<span class="go">    Retrieving 120 files</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sparr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">spt</span><span class="o">=</span><span class="s1">&#39;T5&#39;</span><span class="p">,</span><span class="n">young</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    No files match search criteria</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.getStandard">
<code class="descclassname">splat.</code><code class="descname">getStandard</code><span class="sig-paren">(</span><em>spt</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.getStandard" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Gets one of the pre-defined spectral standards from the SPLAT library.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spt</strong> (<em>required</em>) &#8211; Spectral type of standard desired, either string (&#8216;M7&#8217;) or numberic (17)</li>
<li><strong>sd</strong> (<em>optional, default = False</em>) &#8211; Set to True to get a subdwarf standard</li>
<li><strong>esd</strong> (<em>optional, default = False</em>) &#8211; Set to True to get an extreme subdwarf standard</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getStandard</span><span class="p">(</span><span class="s1">&#39;M7&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Spectrum of VB 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sparr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getStandard</span><span class="p">(</span><span class="s1">&#39;T5&#39;</span><span class="p">,</span><span class="n">esd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Type esdT5.0 is not in esd standards: try one of the following:</span>
<span class="go">    [&#39;esdM5.0&#39;, &#39;esdM7.0&#39;, &#39;esdM8.5&#39;]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="spectral-comparison">
<h3>Spectral Comparison<a class="headerlink" href="#spectral-comparison" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.compareSpectra">
<code class="descclassname">splat.</code><code class="descname">compareSpectra</code><span class="sig-paren">(</span><em>sp1</em>, <em>sp2</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.compareSpectra" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Compare two spectra against each other using a pre-selected statistic. Returns the value of the desired statistic as well as the optimal scale factor. Minimum possible value for statistic is 1.e-9.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp1</strong> (<em>required</em>) &#8211; First spectrum class object, which sets the wavelength scale</li>
<li><strong>sp2</strong> (<em>required</em>) &#8211; Second spectrum class object, interpolated onto the wavelength scale of sp1</li>
<li><strong>statistic</strong> (<em>optional, default = 'chisqr'</em>) &#8211; <p>string defining which statistic to use in comparison; available options are:</p>
<ul>
<li><em>&#8216;chisqr&#8217;</em>: compare by computing chi squared value (requires spectra with noise values)</li>
<li><em>&#8216;stddev&#8217;</em>: compare by computing standard deviation</li>
<li><em>&#8216;stddev_norm&#8217;</em>: compare by computing normalized standard deviation</li>
<li><em>&#8216;absdev&#8217;</em>: compare by computing absolute deviation</li>
</ul>
</li>
<li><strong>fit_ranges</strong> (<em>optional, default = [0.65,2.45]</em>) &#8211; 2-element array or nested array of 2-element arrays specifying the wavelength ranges to be used for the fit, assumed to be measured in microns. This is effectively the opposite of mask_ranges.</li>
<li><strong>weights</strong> (<em>optional, default = [1, ..., 1] for len(sp1.wave)</em>) &#8211; Array specifying the weights for individual wavelengths; must be an array with length equal to the wavelength scale of <code class="docutils literal"><span class="pre">sp1</span></code>; need not be normalized</li>
<li><strong>mask_ranges</strong> (<em>optional, default = None</em>) &#8211; Multi-vector array setting wavelength boundaries for masking data, assumed to be in microns</li>
<li><strong>mask</strong> (<em>optional, default = [0, ..., 0] for len(sp1.wave)</em>) &#8211; Array specifiying which wavelengths to mask; must be an array with length equal to the wavelength scale of <code class="docutils literal"><span class="pre">sp1</span></code> with only 0 (OK) or 1 (mask).</li>
<li><strong>mask_telluric</strong> (<em>optional, default = False</em>) &#8211; Set to True to mask pre-defined telluric absorption regions</li>
<li><strong>mask_standard</strong> (<em>optional, default = False</em>) &#8211; Like <code class="docutils literal"><span class="pre">mask_telluric</span></code>, with a slightly tighter cut of 0.80-2.35 micron</li>
<li><strong>novar2</strong> (<em>optional, default = True</em>) &#8211; Set to True to compute statistic without considering variance of <code class="docutils literal"><span class="pre">sp2</span></code></li>
<li><strong>plot</strong> (<em>optional, default = False</em>) &#8211; Set to True to plot <code class="docutils literal"><span class="pre">sp1</span></code> with scaled <code class="docutils literal"><span class="pre">sp2</span></code> and difference spectrum overlaid</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; Set to True to report things as you&#8217;re going along</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp1</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;2346-3153&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Retrieving 1 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp2</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;1421+1827&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Retrieving 1 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;chisqr&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 19927.74527822856&gt;, 0.94360732593223595)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;stddev&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 3.0237604611215705 erg2 / (cm4 micron2 s2)&gt;, 0.98180983971456637)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;absdev&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 32.99816249949072 erg / (cm2 micron s)&gt;, 0.98155779612333172)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;chisqr&#39;</span><span class="p">,</span> <span class="n">novar2</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 17071.690727945213&gt;, 0.94029474635786015)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="spectral-classification">
<h3>Spectral Classification<a class="headerlink" href="#spectral-classification" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.classifyByIndex">
<code class="descclassname">splat.</code><code class="descname">classifyByIndex</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.classifyByIndex" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Determine the spectral type and uncertainty for a spectrum based on indices. Makes use of published index-SpT relations from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001AJ....121.1710R">Reid et al. (2001)</a>; <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...552L.147T">Testi et al. (2001)</a>; <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...657..511A">Allers et al. (2007)</a>; and <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...659..655B">Burgasser (2007)</a>. Returns 2-element tuple containing spectral type (numeric or string) and uncertainty.</p>
<p>Required Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements.</td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>set</strong> &#8211; <p>named set of indices to measure and compute spectral type</p>
<ul>
<li><em>&#8216;burgasser&#8217;</em>: H2O-J, CH4-J, H2O-H, CH4-H, CH4-K from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...659..655B">Burgasser (2007)</a>, applicable for types  (default)</li>
<li><em>&#8216;allers&#8217;</em>: H2O from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...657..511A">Allers et al. (2007)</a></li>
<li><em>&#8216;reid&#8217;</em>:H2O-A and H2O-B from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001AJ....121.1710R">Reid et al. (2001)</a></li>
<li><em>&#8216;testi&#8217;</em>: sHJ, sKJ, sH2O_J, sH2O_H1, sH2O_H2, sH2O_K from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...552L.147T">Testi et al. (2001)</a></li>
</ul>
</li>
<li><strong>string</strong> &#8211; return spectral type as a string using typeToNum (default = False)</li>
<li><strong>round</strong> &#8211; rounds off to nearest 0.5 subtypes (default = False)</li>
<li><strong>allmeasures</strong> &#8211; Set to True to return all of the index values and individual subtypes  (default = False)</li>
<li><strong>remeasure</strong> &#8211; force remeasurement of indices (default = True)</li>
<li><strong>nsamples</strong> &#8211; number of Monte Carlo samples for error computation (default = 100)</li>
<li><strong>nloop</strong> &#8211; number of testing loops to see if spectral type is within a certain range (default = 5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spc</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;0559-1404&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyByIndex</span><span class="p">(</span><span class="n">spc</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;burgasser&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    (&#39;T4.5&#39;, 0.2562934083414341)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.classifyByStandard">
<code class="descclassname">splat.</code><code class="descname">classifyByStandard</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.classifyByStandard" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Determine the spectral type and uncertainty for a
spectrum by direct comparison to defined spectral standards.
Dwarf standards span M0-T9 and include the standards listed in
<a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...637.1067B">Burgasser et al. (2006)</a>, <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a> and <a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJ...743...50C">Cushing et al. (2011)</a>.
Comparison to subdwarf and extreme subdwarf standards may also be done.
Returns the best
match or an F-test weighted mean and uncertainty. There is an option
to follow the procedure of <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a>, fitting only in
the 0.9-1.4 micron region.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">A tuple listing the best match standard and uncertainty based on F-test weighting and systematic uncertainty of 0.5 subtypes</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and
noise array elements (required)</li>
<li><strong>sptrange</strong> &#8211; set to the spectral type range over which comparisons should be made, can be a two-element array of strings or numbers (optional, default = [&#8216;M0&#8217;,&#8217;T9&#8217;])</li>
<li><strong>statistic</strong> &#8211; <p>string defining which statistic to use in comparison; available options are:</p>
<ul>
<li><em>&#8216;chisqr&#8217;</em>: (DEFAULT) compare by computing chi squared value (requires spectra with noise values)</li>
<li><em>&#8216;stddev&#8217;</em>: compare by computing standard deviation</li>
<li><em>&#8216;stddev_norm&#8217;</em>: compare by computing normalized standard deviation</li>
<li><em>&#8216;absdev&#8217;</em>: compare by computing absolute deviation</li>
</ul>
</li>
<li><strong>method</strong> &#8211; <p>set to <code class="docutils literal"><span class="pre">'kirkpatrick'</span></code> to follow the <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a> method, fitting only to the 0.9-1.4 micron band (optional, default = &#8216;&#8217;)</p>
</li>
<li><strong>best</strong> &#8211; set to True to return the best fit standard type (optional, default = True)</li>
<li><strong>average</strong> &#8211; set to True to return an chi-square weighted type only (optional, default = False)</li>
<li><strong>compareto</strong> &#8211; set to the single standard (string or number) you want to compare to (optional, default = None)</li>
<li><strong>plot</strong> &#8211; set to True to generate a plot comparing best fit template to source; can also set keywords associated with <a href="#id26"><span class="problematic" id="id27">plotSpectrum_</span></a> routine (optional, default = False)</li>
<li><strong>string</strong> &#8211; set to True to return spectral type as a string (optional, default = True)</li>
<li><strong>return_standard</strong> &#8211; set to True to return a Spectrum class of the standard properly scaled (optional, default = False)</li>
<li><strong>verbose</strong> &#8211; set to True to give extra feedback (optional, default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Users can also set keyword parameters defined in <a href="#id28"><span class="problematic" id="id29">plotSpectrum_</span></a> and <a class="reference external" href="api.html#splat.compareSpectra">compareSpectra</a> routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Using dwarf standards</span>
<span class="go">    Type M3.0: statistic = 5763368.10355, scale = 0.000144521824721</span>
<span class="go">    Type M2.0: statistic = 5613862.67356, scale = 0.000406992798674</span>
<span class="go">    Type T8.0: statistic = 18949835.2087, scale = 9.70960919364</span>
<span class="go">    Type T9.0: statistic = 21591485.163, scale = 29.1529786804</span>
<span class="go">    Type L8.0: statistic = 3115605.62687, scale = 1.36392504072</span>
<span class="go">    Type L9.0: statistic = 2413450.79206, scale = 0.821131769522</span>
<span class="go">    ...</span>
<span class="go">    Best match to L1.0 spectral standard</span>
<span class="go">    Best spectral type = L1.0+/-0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">    (&#39;L1.0&#39;, 0.5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">average</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    (&#39;sdL0.0:&#39;, 1.8630159149200021)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.classifyByTemplate">
<code class="descclassname">splat.</code><code class="descname">classifyByTemplate</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.classifyByTemplate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Determine the spectral type and uncertainty for a
spectrum by direct comparison to a large set of spectra in
the library. Returns a dictionary with the best spectral type (F-test weighted mean and
uncertainty), and arrays for the N best-matching Spectrum objects, scale factors, spectral types and comparison statistics.
There is an option to follow the procedure of
<a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a>,
fitting only in the 0.9-1.4 micron region.
It is strongly encouraged that users winnow down the templates used in the comparison
by selecting templates using the <a class="reference external" href="api.html#splat_db.searchLibrary">searchLibrary</a> options or optionally the <code class="docutils literal"><span class="pre">set</span></code> parameter.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">A dictionary containing the following keys:</p>
<ul class="simple">
<li><strong>result</strong>: a tuple containing the spectral type and its uncertainty based on F-test statistic</li>
<li><strong>statistic</strong>: array of N best statistical comparison values</li>
<li><strong>scale</strong>: array of N best optimal scale factors</li>
<li><strong>spectra</strong>: array of N best Spectrum objects</li>
<li><strong>spt</strong>: array of N best spectral types</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and
noise array elements.</li>
<li><strong>sp</strong> &#8211; required</li>
<li><strong>statistic</strong> (<em>optional, default = 'chisqr'</em>) &#8211; <p>string defining which statistic to use in comparison; available options are:</p>
<ul>
<li><em>&#8216;chisqr&#8217;</em>: compare by computing chi squared value (requires spectra with noise values)</li>
<li><em>&#8216;stddev&#8217;</em>: compare by computing standard deviation</li>
<li><em>&#8216;stddev_norm&#8217;</em>: compare by computing normalized standard deviation</li>
<li><em>&#8216;absdev&#8217;</em>: compare by computing absolute deviation</li>
</ul>
</li>
<li><strong>select</strong> (<em>optional, default = ''</em>) &#8211; <p>string defining which spectral template set you want to compare to; several options which can be combined:</p>
<ul>
<li><em>m dwarf</em>: fit to M dwarfs only</li>
<li><em>l dwarf</em>: fit to M dwarfs only</li>
<li><em>t dwarf</em>: fit to M dwarfs only</li>
<li><em>vlm</em>: fit to M7-T9 dwarfs</li>
<li><em>optical</em>: only optical classifications</li>
<li><em>high sn</em>: median S/N greater than 100</li>
<li><em>young</em>: only young/low surface gravity dwarfs</li>
<li><em>companion</em>: only companion dwarfs</li>
<li><em>subdwarf</em>: only subdwarfs</li>
<li><em>single</em>: only dwarfs not indicated a binaries</li>
<li><em>spectral binaries</em>: only dwarfs indicated to be spectral binaries</li>
<li><em>standard</em>: only spectral standards (Note: use <a class="reference external" href="api.html#splat.classifyByStandard">classifyByStandard</a> instead)</li>
</ul>
</li>
<li><strong>method</strong> (<em>optional, default = ''</em>) &#8211; <p>set to <code class="docutils literal"><span class="pre">'kirkpatrick'</span></code> to follow the <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a> method, fitting only to the 0.9-1.4 micron band</p>
</li>
<li><strong>best</strong> (<em>optional, default = False</em>) &#8211; Set to True to return only the best fit template type</li>
<li><strong>nbest</strong> (<em>optional, default = 1</em>) &#8211; Set to the number of best fitting spectra to return</li>
<li><strong>maxtemplates</strong> (<em>optional, default = 100</em>) &#8211; Set to the maximum number of templates that should be fit</li>
<li><strong>force</strong> (<em>optional, default = False</em>) &#8211; By default, classifyByTemplate won&#8217;t proceed if you have more than 100 templates; set this parameter to True to ignore that constraint</li>
<li><strong>plot</strong> (<em>optional, default = False</em>) &#8211; Set to True to generate a plot comparing best fit template to source; can also set keywords associated with <a href="#id30"><span class="problematic" id="id31">plotSpectrum_</span></a> routine</li>
<li><strong>string</strong> (<em>optional, default = True</em>) &#8211; return spectral type as a string</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; give lots of feedback</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Users can also set keyword parameters defined in <a href="#id32"><span class="problematic" id="id33">plotSpectrum_</span></a> and <a class="reference external" href="api.html#splat_db.searchLibrary">searchLibrary</a> routines</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByTemplate</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">spt</span><span class="o">=</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span><span class="mi">26</span><span class="p">],</span><span class="n">nbest</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">    Too many templates (171) for classifyByTemplate; set force=True to override this</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByTemplate</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">spt</span><span class="o">=</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span><span class="mi">26</span><span class="p">],</span><span class="n">snr</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">nbest</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">    Comparing to 98 templates</span>
<span class="go">    LHS 102B L5.0 10488.1100432 11.0947838116</span>
<span class="go">    2MASSI J0013578-223520 L4.0 7037.37441677 136.830522173</span>
<span class="go">    SDSS J001608.44-004302.3 L5.5 15468.6209466 274.797693706</span>
<span class="go">    2MASSI J0028394+150141 L4.5 63696.1897668 187.266152375</span>
<span class="go">    ...</span>
<span class="go">    Best match = DENIS-P J153941.96-052042.4 with spectral type L4:</span>
<span class="go">    Mean spectral type = L4.5+/-0.718078660103</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">    {&#39;result&#39;: (&#39;L4.5&#39;, 0.71807866010293797),</span>
<span class="go">     &#39;scale&#39;: [3.0379089778408642e-14,</span>
<span class="go">      96.534933767992072,</span>
<span class="go">      3.812718429200959,</span>
<span class="go">      2.9878801833735986e-14,</span>
<span class="go">      3.0353579048704484e-14],</span>
<span class="go">     &#39;spectra&#39;: [Spectrum of DENIS-P J153941.96-052042.4,</span>
<span class="go">      Spectrum of 2MASSI J0443058-320209,</span>
<span class="go">      Spectrum of SDSSp J053951.99-005902.0,</span>
<span class="go">      Spectrum of 2MASSI J1104012+195921,</span>
<span class="go">      Spectrum of 2MASS J17502484-0016151],</span>
<span class="go">     &#39;spt&#39;: [24.0, 25.0, 25.0, 24.0, 25.5],</span>
<span class="go">     &#39;statistic&#39;: [&lt;Quantity 2108.997879536768&gt;,</span>
<span class="go">      &lt;Quantity 2205.640664932956&gt;,</span>
<span class="go">      &lt;Quantity 2279.316858783139&gt;,</span>
<span class="go">      &lt;Quantity 2579.0089210846527&gt;,</span>
<span class="go">      &lt;Quantity 2684.003187310027&gt;]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.classifyGravity">
<code class="descclassname">splat.</code><code class="descname">classifyGravity</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.classifyGravity" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Determine the gravity classification of a brown dwarf using the method of <a class="reference external" href="http://adsabs.harvard.edu/abs/2013ApJ...772...79A">Allers &amp; Liu (2013)</a>.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> (<em>required</em>) &#8211; Spectrum class object, which should contain wave, flux and
noise array elements. Must be between M6.0 and L7.0.</li>
<li><strong>spt</strong> (<em>optional, default = False</em>) &#8211; spectral type of <code class="docutils literal"><span class="pre">sp</span></code>. Must be between M6.0 and L7.0</li>
<li><strong>indices</strong> (<em>optional, default = 'allers'</em>) &#8211; specify indices set using <code class="docutils literal"><span class="pre">measureIndexSet</span></code>.</li>
<li><strong>plot</strong> (<em>optional, default = False</em>) &#8211; Set to True to plot sources against closest dwarf spectral standard</li>
<li><strong>allscores</strong> (<em>optional, default = False</em>) &#8211; Set to True to return a dictionary containing the gravity scores from individual indices</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; Give feedback while computing</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">Either a string specifying the gravity classification or a dictionary specifying the gravity scores for each index</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyGravity</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="go">    FLD-G</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyGravity</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">allscores</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Gravity Classification:</span>
<span class="go">        SpT = L4.0</span>
<span class="go">        VO-z: 1.012+/-0.029 =&gt; 0.0</span>
<span class="go">        FeH-z: 1.299+/-0.031 =&gt; 1.0</span>
<span class="go">        H-cont: 0.859+/-0.032 =&gt; 0.0</span>
<span class="go">        KI-J: 1.114+/-0.038 =&gt; 1.0</span>
<span class="go">        Gravity Class = FLD-G</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">    {&#39;FeH-z&#39;: 1.0,</span>
<span class="go">     &#39;H-cont&#39;: 0.0,</span>
<span class="go">     &#39;KI-J&#39;: 1.0,</span>
<span class="go">     &#39;VO-z&#39;: 0.0,</span>
<span class="go">     &#39;gravity_class&#39;: &#39;FLD-G&#39;,</span>
<span class="go">     &#39;score&#39;: 0.5,</span>
<span class="go">     &#39;spt&#39;: &#39;L4.0&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.initiateStandards">
<code class="descclassname">splat.</code><code class="descname">initiateStandards</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.initiateStandards" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Initiates the spectral standards in the SpeX library. By default this loads the dwarfs standards, but you can also specify loading of subdwarf and extreme subdwarf standards as well. Once loaded, these standards remain in memory.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sd</strong> (<em>optional, default = False</em>) &#8211; Set equal to True to load subdwarf standards</li>
<li><strong>esd</strong> (<em>optional, default = False</em>) &#8211; Set equal to True to load extreme subdwarf standards</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">initiateStandards</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">SPEX_STDS</span><span class="p">[</span><span class="s1">&#39;M5.0&#39;</span><span class="p">]</span>
<span class="go">Spectrum of Gl51</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.metallicity">
<code class="descclassname">splat.</code><code class="descname">metallicity</code><span class="sig-paren">(</span><em>sp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.metallicity" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Metallicity measurement using Na I and Ca I lines and H2O-K2 index as described in <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...748...93R">Rojas-Ayala et al.(2012)</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</li>
<li><strong>nsamples</strong> (<em>optional, default = 100</em>) &#8211; number of Monte Carlo samples for error computation</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;0559-1404&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">metallicity</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="go">    (-0.50726104530066363, 0.24844773591243882)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="spectrophotometry">
<h3>Spectrophotometry<a class="headerlink" href="#spectrophotometry" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.filterMag">
<code class="descclassname">splat.</code><code class="descname">filterMag</code><span class="sig-paren">(</span><em>sp</em>, <em>filt</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.filterMag" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Determine the photometric magnitude of a source based on its
spectrum. Spectral fluxes are convolved with the filter profile specified by
the <code class="docutils literal"><span class="pre">filter</span></code> input.  By default this filter is also
convolved with a model of Vega to extract Vega magnitudes,
but the user can also specify AB magnitudes, photon flux or
energy flux.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> (<em>required</em>) &#8211; Spectrum class object, which should contain wave, flux and
noise array elements.</li>
<li><strong>filter</strong> (<em>required</em>) &#8211; String giving name of filter, which can either be one of the predefined filters listed in splat.FILTERS.keys() or a custom filter name</li>
<li><strong>custom</strong> (<em>optional, default = None</em>) &#8211; A 2 x N vector array specifying the wavelengths and transmissions for a custom filter</li>
<li><strong>notch</strong> (<em>optional, default = None</em>) &#8211; A 2 element array that specifies the lower and upper wavelengths for a notch filter (100% transmission within, 0% transmission without)</li>
<li><strong>vega</strong> (<em>optional, default = True</em>) &#8211; compute Vega magnitudes</li>
<li><strong>ab</strong> (<em>optional, default = False</em>) &#8211; compute AB magnitudes</li>
<li><strong>energy</strong> (<em>optional, default = False</em>) &#8211; compute energy flux</li>
<li><strong>photon</strong> (<em>optional, default = False</em>) &#8211; compute photon flux</li>
<li><strong>filterFolder</strong> (<em>optional, default = splat.FILTER_FOLDER</em>) &#8211; folder containing the filter transmission files</li>
<li><strong>vegaFile</strong> (<em>optional, default = vega_kurucz.txt</em>) &#8211; name of file containing Vega flux file, must be within <code class="docutils literal"><span class="pre">filterFolder</span></code></li>
<li><strong>nsamples</strong> (<em>optional, default = 100</em>) &#8211; number of samples to use in Monte Carlo error estimation</li>
<li><strong>info</strong> (<em>optional, default = False</em>) &#8211; List the predefined filter names available</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.photometry</span> <span class="k">as</span> <span class="nn">spphot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">14.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spphot</span><span class="o">.</span><span class="n">filterMag</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="s1">&#39;MKO J&#39;</span><span class="p">)</span>
<span class="go">    (14.345894376898123, 0.027596454828421831)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="other-spectral-analyses">
<h3>Other Spectral Analyses<a class="headerlink" href="#other-spectral-analyses" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.measureIndex">
<code class="descclassname">splat.</code><code class="descname">measureIndex</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.measureIndex" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Measure an index on a spectrum based on defined methodology
measure method can be mean, median, integrate
index method can be ratio = 1/2, valley = 1-2/3, OTHERS
output is index value and uncertainty</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p># NOTE: NOISE FLAG ERROR IS BACKWARDS HERE</p>
</dd></dl>

<dl class="function">
<dt id="splat.measureIndexSet">
<code class="descclassname">splat.</code><code class="descname">measureIndexSet</code><span class="sig-paren">(</span><em>sp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.measureIndexSet" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Measures indices of <code class="docutils literal"><span class="pre">sp</span></code> from specified sets. Returns dictionary of indices.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</li>
<li><strong>set</strong> (<em>optional, default = 'burgasser'</em>) &#8211; <p>string defining which indices set you want to use; options include:</p>
<ul>
<li><em>bardalez</em>: H2O-J, CH4-J, H2O-H, CH4-H, H2O-K, CH4-K, K-J, H-dip, K-slope, J-slope, J-curve, H-bump, H2O-Y from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...794..143B">Bardalez Gagliuffi et al. (2014)</a></li>
<li><em>burgasser</em>: H2O-J, CH4-J, H2O-H, CH4-H, H2O-K, CH4-K, K-J from <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...637.1067B">Burgasser et al. (2006)</a></li>
<li><em>tokunaga</em>: K1, K2 from <a class="reference external" href="http://adsabs.harvard.edu/abs/1999AJ....117.1010T">Tokunaga &amp; Kobayashi (1999)</a></li>
<li><em>reid</em>: H2O-A, H2O-B from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001AJ....121.1710R">Reid et al. (2001)</a></li>
<li><em>geballe</em>: H2O-1.2, H2O-1.5, CH4-2.2 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2002ApJ...564..466G">Geballe et al. (2002)</a></li>
<li><em>allers</em>: H2O, FeH-z, VO-z, FeH-J, KI-J, H-cont from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...657..511A">Allers et al. (2007)</a>, <a class="reference external" href="http://adsabs.harvard.edu/abs/2013ApJ...772...79A">Allers &amp; Liu (2013)</a></li>
<li><em>testi</em>: sHJ, sKJ, sH2O-J, sH2O-H1, sH2O-H2, sH2O-K from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...552L.147T">Testi et al. (2001)</a></li>
<li><em>slesnick</em>: H2O-1, H2O-2, FeH from <a class="reference external" href="http://adsabs.harvard.edu/abs/2004ApJ...610.1045S">Slesnick et al. (2004)</a></li>
<li><em>mclean</em>: H2OD from <a class="reference external" href="http://adsabs.harvard.edu/abs/2003ApJ...596..561M">McLean et al. (2003)</a></li>
<li><em>rojas</em>: H2O-K2 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...748...93R">Rojas-Ayala et al.(2012)</a></li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1555+0954&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">measureIndexSet</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="s1">&#39;reid&#39;</span><span class="p">)</span>
<span class="go">    {&#39;H2O-B&#39;: (1.0531856077273236, 0.0045092074790538221), &#39;H2O-A&#39;: (0.89673318593633422, 0.0031278302105038594)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.measureEW">
<code class="descclassname">splat.</code><code class="descname">measureEW</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.measureEW" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Measures equivalent widths (EWs) of specified lines</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</li>
<li><strong>args</strong> &#8211; wavelength arrays. Needs at least two arrays to measure line and continuum regions.</li>
<li><strong>nonoise</strong> (<em>optional, default = ''</em>) &#8211; </li>
<li><strong>line</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.measureEWSet">
<code class="descclassname">splat.</code><code class="descname">measureEWSet</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.measureEWSet" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Measures equivalent widths (EWs) of lines from specified sets. Returns dictionary of indices.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</li>
<li><strong>set</strong> (<em>optional, default = 'rojas'</em>) &#8211; <p>string defining which EW measurement set you want to use; options include:</p>
<ul>
<li><em>rojas</em>: EW measures from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...748...93R">Rojas-Ayala et al. (2012)</a>;
uses Na I 2.206/2.209 Ca I 2.26 micron lines.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1555+0954&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">measureEWSet</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="s1">&#39;rojas&#39;</span><span class="p">)</span>
<span class="go">    {&#39;Na I 2.206/2.209&#39;: (1.7484002652013144, 0.23332441577025356), &#39;Ca I 2.26&#39;: (1.3742491939667159, 0.24867705962337672), &#39;names&#39;: [&#39;Na I 2.206/2.209&#39;, &#39;Ca I 2.26&#39;], &#39;reference&#39;: &#39;EW measures from Rojas-Ayala et al. (2012)&#39;}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="empirical-relationships">
<h3>Empirical Relationships<a class="headerlink" href="#empirical-relationships" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="conversion-routines">
<h3>Conversion Routines<a class="headerlink" href="#conversion-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.coordinateToDesignation">
<code class="descclassname">splat.</code><code class="descname">coordinateToDesignation</code><span class="sig-paren">(</span><em>c</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.coordinateToDesignation" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Converts right ascension and declination into a designation string</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>c</strong> &#8211; RA and Dec coordinate to be converted; can be a SkyCoord object with units of degrees,
a list with RA and Dec in degrees, or a string with RA measured in hour
angles and Dec in degrees</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">Designation string</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="k">import</span> <span class="n">SkyCoord</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">238.86</span><span class="p">,</span> <span class="mf">9.90</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">    J15552640+0954000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">([</span><span class="mf">238.86</span><span class="p">,</span> <span class="mf">9.90</span><span class="p">])</span>
<span class="go">    J15552640+0954000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">(</span><span class="s1">&#39;15:55:26.4 +09:54:00.0&#39;</span><span class="p">)</span>
<span class="go">    J15552640+0954000</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.designationToCoordinate">
<code class="descclassname">splat.</code><code class="descname">designationToCoordinate</code><span class="sig-paren">(</span><em>value</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.designationToCoordinate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Convert a designation srtring into a RA, Dec tuple or ICRS SkyCoord objects (default)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<em>required</em>) &#8211; Designation string with RA measured in hour angles and Dec in degrees</li>
<li><strong>icrs</strong> (<em>optional, defualt = True</em>) &#8211; returns astropy SkyCoord coordinate in ICRS frame if <code class="docutils literal"><span class="pre">True</span></code></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">Coordinate, either as [RA, Dec] or SkyCoord object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">designationToCoordinate</span><span class="p">(</span><span class="s1">&#39;J1555264+0954120&#39;</span><span class="p">)</span>
<span class="go">&lt;SkyCoord (ICRS): (ra, dec) in deg</span>
<span class="go">    (238.8585, 9.90333333)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.designationToShortName">
<code class="descclassname">splat.</code><code class="descname">designationToShortName</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.designationToShortName" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Produce a shortened version of designation</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>required</em>) &#8211; Designation string with RA measured in hour angles and Dec in degrees</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">Shorthand designation string</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">designationToShortName</span><span class="p">(</span><span class="s1">&#39;J1555264+0954120&#39;</span><span class="p">)</span>
<span class="go">    J1555+0954</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.typeToNum">
<code class="descclassname">splat.</code><code class="descname">typeToNum</code><span class="sig-paren">(</span><em>inp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.typeToNum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts between string and numeric spectral types, and vise versa.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input</strong> &#8211; Spectral type to convert. Can convert a number or a string from 0 (K0) and 49.0 (Y9).</li>
<li><strong>error</strong> (<em>optional, default = ''</em>) &#8211; magnitude of uncertainty. &#8216;:&#8217; for uncertainty &gt; 1 and &#8216;::&#8217; for uncertainty &gt; 2.</li>
<li><strong>uncertainty</strong> (<em>optional, default = 0</em>) &#8211; uncertainty of spectral type</li>
<li><strong>subclass</strong> (<em>optional, default = ''</em>) &#8211; <p>subclass of object. Options include:</p>
<ul>
<li><em>sd</em>: object is a subdwarf</li>
<li><em>esd</em>: object is an extreme subdwarf</li>
<li><em>usd</em>: object is an ultra subdwarf</li>
</ul>
</li>
<li><strong>lumclass</strong> (<em>optional, default = ''</em>) &#8211; luminosity class of object represented by roman numerals</li>
<li><strong>ageclass</strong> (<em>optional, default = ''</em>) &#8211; age class of object</li>
<li><strong>colorclass</strong> (<em>optional, default = ''</em>) &#8211; color class of object</li>
<li><strong>peculiar</strong> (<em>optional, default = False</em>) &#8211; if object is peculiar or not</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">    T0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="s1">&#39;T0.0&#39;</span><span class="p">)</span>
<span class="go">    30.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="n">peculiar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">lumclass</span> <span class="o">=</span> <span class="s1">&#39;II&#39;</span><span class="p">)</span>
<span class="go">    L7.0IIp:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">    Spectral type number must be between 0 (K0) and 49.0 (Y9)</span>
<span class="go">    nan</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.properCoordinates">
<code class="descclassname">splat.</code><code class="descname">properCoordinates</code><span class="sig-paren">(</span><em>c</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.properCoordinates" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Converts various coordinate forms to the proper SkyCoord format. Convertible forms include lists and strings.</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>c</strong> &#8211; coordinate to be converted. Can be a list (ra, dec) or a string.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">([</span><span class="mf">104.79</span><span class="p">,</span> <span class="mf">25.06</span><span class="p">])</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;06:59:09.60 +25:03:36.0&#39;</span><span class="p">)</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J06590960+2503360&#39;</span><span class="p">)</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.isNumber">
<code class="descclassname">splat.</code><code class="descname">isNumber</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.isNumber" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Checks if something is a number.</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<em>required</em>) &#8211; object to be checked</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">True or False</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">    True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isNumber</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="plotting-routines">
<h3>Plotting Routines<a class="headerlink" href="#plotting-routines" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="utility-routines">
<h3>Utility Routines<a class="headerlink" href="#utility-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.weightedMeanVar">
<code class="descclassname">splat.</code><code class="descname">weightedMeanVar</code><span class="sig-paren">(</span><em>vals</em>, <em>winp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.weightedMeanVar" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Computes weighted mean of an array of values through various methods. Returns weighted mean and weighted uncertainty.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vals</strong> &#8211; array of values</li>
<li><strong>winp</strong> &#8211; array of weights associated with <code class="docutils literal"><span class="pre">vals</span></code></li>
<li><strong>method</strong> (<em>optional, default = ''</em>) &#8211; <p>input type of weights. Default is where <code class="docutils literal"><span class="pre">winp</span></code> is the actual weights of <code class="docutils literal"><span class="pre">vals</span></code>. Options include:</p>
<ul>
<li><em>uncertainty</em>: uncertainty weighting, where <code class="docutils literal"><span class="pre">winp</span></code> is the uncertainties of <code class="docutils literal"><span class="pre">vals</span></code></li>
<li><em>ftest</em>: ftest weighting, where <code class="docutils literal"><span class="pre">winp</span></code> is the chi squared values of <code class="docutils literal"><span class="pre">vals</span></code></li>
</ul>
</li>
<li><strong>weight_minimum</strong> (<em>optional, default = 0.</em>) &#8211; minimum possible weight value</li>
<li><strong>dof</strong> (<em>optional, default = len(vals) - 1</em>) &#8211; effective degrees of freedom</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using <code class="docutils literal"><span class="pre">ftest</span></code> method, extra <code class="docutils literal"><span class="pre">dof</span></code> value is required</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">weightedMeanVar</span><span class="p">([</span><span class="mf">3.52</span><span class="p">,</span> <span class="mf">5.88</span><span class="p">,</span> <span class="mf">9.03</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">])</span>
<span class="go">    (5.0057009345794379, 4.3809422657000594)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">weightedMeanVar</span><span class="p">([</span><span class="mf">3.52</span><span class="p">,</span> <span class="mf">5.88</span><span class="p">,</span> <span class="mf">9.03</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.24</span><span class="p">,</span> <span class="mf">2.09</span><span class="p">,</span> <span class="mf">2.29</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;uncertainty&#39;</span><span class="p">)</span>
<span class="go">    (5.0069199363443841, 4.3914329968409946)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.distributionStats">
<code class="descclassname">splat.</code><code class="descname">distributionStats</code><span class="sig-paren">(</span><em>x, q=[0.16, 0.5, 0.84], weights=None, sigma=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.distributionStats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Find key values along distributions based on quantile steps.
This code is derived almost entirely from triangle.py.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="i-o-routines">
<h3>I/O Routines<a class="headerlink" href="#i-o-routines" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="modeling-routines">
<h2>Modeling Routines<a class="headerlink" href="#modeling-routines" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spectral-modeling-routines">
<h3>Spectral Modeling Routines<a class="headerlink" href="#spectral-modeling-routines" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="evolutionary-model-routines">
<h3>Evolutionary Model Routines<a class="headerlink" href="#evolutionary-model-routines" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="specialty-packages">
<h2>Specialty Packages<a class="headerlink" href="#specialty-packages" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euclid-analysis-routines">
<h3>EUCLID Analysis Routines<a class="headerlink" href="#euclid-analysis-routines" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="bibtex-routines">
<h3>BibTeX Routines<a class="headerlink" href="#bibtex-routines" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="astroquery-based-data-access">
<h3>Astroquery-based Data Access<a class="headerlink" href="#astroquery-based-data-access" title="Permalink to this headline">¶</a></h3>
<p><em>Search</em></p>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="splat_evolve.html" class="btn btn-neutral" title="Brown Dwarf Evolutionary Models" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Adam Burgasser.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.31',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>