

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API &mdash; SpeX Prism Library Analysis Toolkit 0.5.dev documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/logo.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="SpeX Prism Library Analysis Toolkit 0.5.dev documentation" href="index.html"/>
        <link rel="prev" title="Brown Dwarf Evolutionary Models" href="splat_evolve.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SpeX Prism Library Analysis Toolkit
          

          
            
            <img src="_static/logo.jpg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.5.dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation and Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat.html">Main SPLAT module</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_plot.html">SPLAT Plotting Routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_model.html">SPLAT Spectral Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_evolve.html">Brown Dwarf Evolutionary Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#splat-classes">SPLAT Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectrum">Spectrum</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#splat-routines">SPLAT Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#database-access">Database Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spectral-comparison">Spectral Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spectral-classification">Spectral Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spectrophotometry">Spectrophotometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-spectral-analyses">Other Spectral Analyses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#empirical-relationships">Empirical Relationships</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-routines">Conversion Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-routines">Plotting Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utility-routines">Utility Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#i-o-routines">I/O Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modeling-routines">Modeling Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectral-modeling-routines">Spectral Modeling Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evolutionary-model-routines">Evolutionary Model Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#specialty-packages">Specialty Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#euclid-analysis-routines">EUCLID Analysis Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bibtex-routines">BibTeX Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#astroquery-based-data-access">Astroquery-based Data Access</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SpeX Prism Library Analysis Toolkit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>API</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/api.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="splat-classes">
<h2>SPLAT Classes<a class="headerlink" href="#splat-classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spectrum">
<h3>Spectrum<a class="headerlink" href="#spectrum" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="splat.Spectrum">
<em class="property">class </em><code class="descclassname">splat.</code><code class="descname">Spectrum</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Primary class for containing spectral and source data for SpeX Prism Library.</td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ismodel</strong> &#8211; Set to True to specify spectrum as a model (default = False)</li>
<li><strong>wlabel</strong> &#8211; label of wavelength (default = &#8216;Wavelength&#8217;)</li>
<li><strong>wunit</strong> &#8211; unit in which wavelength is measured (default = u.micron)</li>
<li><strong>wunit_label</strong> &#8211; label of the unit of wavelength (default = &#8216;micron&#8217;)</li>
<li><strong>flabel</strong> &#8211; label of flux density (default = &#8216;F_lambda&#8217;)</li>
<li><strong>fscale</strong> &#8211; string describing how flux density is scaled (default = &#8216;&#8217;)</li>
<li><strong>funit</strong> &#8211; unit in which flux density is measured (default = u.erg/(u.cm**2 * u.s * u.micron)</li>
<li><strong>funit_label</strong> &#8211; label of the unit of flux density (default = &#8216;erg cm^-2 s^-1 micron^-1&#8217;)</li>
<li><strong>resolution</strong> &#8211; Resolution of spectrum (default = 150)</li>
<li><strong>slitpixelwidth</strong> &#8211; Width of the slit measured in subpixel values (default = 3.33)</li>
<li><strong>slitwidth</strong> &#8211; Actual width of the slit, measured in arcseconds. Default value is the <code class="docutils literal"><span class="pre">slitpixelwidth</span></code> multiplied an assumed (for SpeX) spectrograph pixel scale of 0.15 arcseconds</li>
<li><strong>header</strong> &#8211; header info of the spectrum (default = Table())</li>
<li><strong>filename</strong> &#8211; a string containing the spectrum&#8217;s filename (default = &#8216;&#8217;)</li>
<li><strong>file</strong> &#8211; same as filename (default = &#8216;&#8217;)</li>
<li><strong>idkey</strong> &#8211; spectrum key of the desired spectrum (default = False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;myspectrum.fits&#39;</span><span class="p">)</span>      <span class="c1"># read in a file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;myspectrum.fits&#39;</span><span class="p">)</span>               <span class="c1"># same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10002</span><span class="p">)</span>                           <span class="c1"># read in spectrum with idkey = 10002</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wavearray</span><span class="p">,</span><span class="n">flux</span><span class="o">=</span><span class="n">fluxarray</span><span class="p">)</span>   <span class="c1"># create objects with wavelength &amp; flux arrays</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="splat.Spectrum.computeSN">
<code class="descname">computeSN</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.computeSN" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Compute a representative S/N value as the median value of S/N among the top 50% of flux values</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">the S/N value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">115.96374031163553</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.copy" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Make a copy of a Spectrum object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.export" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Exports a Spectrum object to either a fits or ascii file, depending on file extension given.  If no filename is explicitly given, the Spectrum.filename attribute is used. If the filename does not include the full path, the file is saved in the current directory.  Spectrum.export and <a class="reference external" href="api.html#splat.Spectrum.save">Spectrum.save</a> function in the same manner.</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> (<em>optional, default = Spectrum.simplefilename</em>) &#8211; String specifying the filename to save</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">An ascii or fits file with the data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;/Users/adam/myspectrum.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">ascii</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/Users/adam/myspectrum.txt&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;tab&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go"> &lt;Table length=564&gt;</span>
<span class="go">   wavelength          flux          uncertainty</span>
<span class="go">    float64          float64           float64</span>
<span class="go"> -------------- ----------------- -----------------</span>
<span class="go"> 0.645418405533               0.0               nan</span>
<span class="go"> 0.647664904594 6.71920214475e-16 3.71175052033e-16</span>
<span class="go"> 0.649897933006 1.26009925777e-15 3.85722895842e-16</span>
<span class="go"> 0.652118623257 7.23781818374e-16 3.68178778862e-16</span>
<span class="go"> 0.654327988625 1.94569566622e-15 3.21007116982e-16</span>
<span class="go"> ...</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.flamToFnu">
<code class="descname">flamToFnu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.flamToFnu" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts flux density from F_lambda to F_nu, the latter in Jy. This routine changes the underlying Spectrum object. There is no change if the spectrum is already in F_nu units.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flamToFnu</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Jy&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.fluxCalibrate">
<code class="descname">fluxCalibrate</code><span class="sig-paren">(</span><em>filter</em>, <em>mag</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.fluxCalibrate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Flux calibrates a spectrum given a filter and a magnitude. The filter must be one of those listed in <cite>splat.FILTERS.keys()</cite>. It is possible to specifically set the magnitude to be absolute (by default it is apparent).  This function changes the Spectrum object&#8217;s flux, noise and variance arrays.</td>
</tr>
</tbody>
</table>
<p>Required Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filter</strong> &#8211; string specifiying the name of the filter</li>
<li><strong>mag</strong> &#8211; number specifying the magnitude to scale to</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>absolute</strong> &#8211; set to True to specify that the given magnitude is an absolute magnitude, which sets the <code class="docutils literal"><span class="pre">fscale</span></code> keyword in the Spectrum object to &#8216;Absolute&#8217; (default = False)</li>
<li><strong>apparent</strong> &#8211; set to True to specify that the given magnitude is an apparent magnitude, which sets the <code class="docutils literal"><span class="pre">fscale</span></code> flag in the Spectrum object to &#8216;Apparent&#8217; (default = False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Outputs:</p>
<p>None, Spectrum object is changed to a flux calibrated spectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">filterMag</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go"> (15.002545668628173, 0.017635234089677564)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.fluxMax">
<code class="descname">fluxMax</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.fluxMax" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Reports the maximum flux of a Spectrum object ignoring nan&#8217;s.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>maskTelluric</strong> (<em>optional, default = True</em>) &#8211; masks telluric regions</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">maximum flux (with units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.fnuToFlam">
<code class="descname">fnuToFlam</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.fnuToFlam" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts flux density from F_nu to F_lambda, the latter in erg/s/cm^2/Hz. This routine changes the underlying Spectrum object. There is no change if the spectrum is already in F_lambda units.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flamToFnu</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Jy&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fnuToFlam</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;erg / (cm2 micron s)&quot;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.info">
<code class="descname">info</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.info" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Returns a summary of properties for the Spectrum object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">Text summary</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"> Spectrum of NLTT 184</span>
<span class="go"> Observed on 20071012</span>
<span class="go"> at an airmass of 1.145</span>
<span class="go"> Full source designation is J00054517+0723423</span>
<span class="go"> Median S/N = 97.0</span>
<span class="go"> SPLAT source key is 10012.0</span>
<span class="go"> SPLAT spectrum key is 10857</span>
<span class="go"> Data published in Kirkpatrick, J. D. et al. (2010, ApJS, 190, 100-146)</span>
<span class="go"> History:</span>
<span class="go">     Spectrum successfully loaded</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.normalize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Normalize a spectrum to a maximum value of 1 (in its current units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>waveRange</strong> (<em>optional, default = None</em>) &#8211; choose the wavelength range to normalize; can be a list specifying minimum and maximum or a single number to normalize around a particular point</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">maximum flux (with units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">waverange</span><span class="o">=</span><span class="p">[</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.591310977935791 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.plot" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">calls the <a href="#id86"><span class="problematic" id="id87">plotSpectrum_</span></a> function, by default showing the noise spectrum and zeropoints. See the <a href="#id88"><span class="problematic" id="id89">plotSpectrum_</span></a> API listing for details.</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">A plot of the Spectrum object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.reset" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Restores a Spectrum to its original read-in state, removing scaling and smoothing. This routine changes the Spectrum object directly and there is no output.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 4.561630292384622e-15 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 0.9999999403953552 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 4.561630292384622e-15 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.save" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Exports a Spectrum object to either a fits or ascii file, depending on file extension given.  If no filename is explicitly given, the Spectrum.filename attribute is used. If the filename does not include the full path, the file is saved in the current directory.</td>
</tr>
</tbody>
</table>
<p><a class="reference external" href="api.html#splat.Spectrum.export">Spectrum.export()</a> and <cite>Spectrum.save</cite> function in the same manner.</p>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.scale">
<code class="descname">scale</code><span class="sig-paren">(</span><em>factor</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.scale" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Scales a Spectrum object&#8217;s flux and noise values by a constant factor. This routine changes the Spectrum object directly.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>factor</strong> (<em>required, default = None</em>) &#8211; A floating point number used to scale the Spectrum object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">maximum flux (with units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.showHistory">
<code class="descname">showHistory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.showHistory" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Report history of actions taken on a Spectrum object. This can also be retrieved by printing the attribute Spectrum.history</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">List of actions taken on spectrum</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">showHistory</span><span class="p">()</span>
<span class="go"> Spectrum successfully loaded</span>
<span class="go"> Spectrum normalized</span>
<span class="go"> Flux calibrated with 2MASS J filter to an apparent magnitude of 15.0</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.smooth">
<code class="descname">smooth</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.smooth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Smoothes a spectrum either by selecting a constant slit width (smooth in spectral dispersion space), pixel width (smooth in pixel space) or resolution (smooth in velocity space). One of these options must be selected for any smoothing to happen. Changes spectrum directly.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> (<em>optional, default = Hanning</em>) &#8211; the type of smoothing window to use. See <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html">http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html</a> for more details.</li>
<li><strong>resolution</strong> (<em>optional, default = None</em>) &#8211; Constant resolution to smooth toe(see <a class="reference external" href="api.html#splat.Spectrum.smoothToResolution">smoothToResolution</a>)</li>
<li><strong>slitPixelWidth</strong> (<em>optional, default = None</em>) &#8211; Number of pixels to smooth in pixel space (see <a class="reference external" href="api.html#splat.Spectrum.smoothToSlitPixelWidth">smoothToSlitPixelWidth</a>)</li>
<li><strong>slitWidth</strong> (<em>optional, default = None</em>) &#8211; Number of pixels to smooth in angular space (see <a class="reference external" href="api.html#splat.Spectrum.smoothToPixelWidth">smoothToPixelWidth</a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothfluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.smoothToResolution">
<code class="descname">smoothToResolution</code><span class="sig-paren">(</span><em>resolution</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.smoothToResolution" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Smoothes a spectrum to a constant or resolution (smooth in velocity space). Changes spectrum directly.  Note that no smoothing is done if requested resolution is greater than the current resolution</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>resolution</strong> (<em>required</em>) &#8211; number giving the desired resolution</li>
<li><strong>method</strong> (<em>optional, default = Hanning</em>) &#8211; the type of smoothing window to use. See <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html">http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html</a> for more details.</li>
<li><strong>overscale</strong> (<em>optional, default = 10.</em>) &#8211; used for computing number of samples in the window</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">21.550974</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothToResolution</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">49.459522314460855</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.smoothToSlitPixelWidth">
<code class="descname">smoothToSlitPixelWidth</code><span class="sig-paren">(</span><em>width</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.smoothToSlitPixelWidth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Smoothes a spectrum to a constant slit pixel width (smooth in pixel space). Changes spectrum directly.  Note that no smoothing is done if requested width is greater than the current slit width.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>width</strong> (<em>required</em>) &#8211; number giving the desired smoothing scale in pixels</li>
<li><strong>method</strong> (<em>optional, default = Hanning</em>) &#8211; the type of smoothing window to use. See <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html">http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html</a> for more details.</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitpixelwidth</span>
<span class="go">3.33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">105.41789</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothToSlitPixelWidth</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitpixelwidth</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span>
<span class="go">39.96</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">235.77536310249229</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.smoothToSlitWidth">
<code class="descname">smoothToSlitWidth</code><span class="sig-paren">(</span><em>width</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.smoothToSlitWidth" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Smoothes a spectrum to a constant slit angular width (smooth in dispersion space). Changes spectrum directly.  Note that no smoothing is done if requested width is greater than the current slit width.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>width</strong> (<em>required</em>) &#8211; number giving the desired smoothing scale in arcseconds</li>
<li><strong>method</strong> (<em>optional, default = Hanning</em>) &#8211; the type of smoothing window to use. See <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html">http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html</a> for more details.</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">maximum flux (with units)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitwidth</span>
<span class="go">0.4995</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">105.41789</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothToSlitWidth</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitwidth</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span>
<span class="go">29.97</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">258.87135134070593</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.surface">
<code class="descname">surface</code><span class="sig-paren">(</span><em>radius</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.surface" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Convert to surface fluxes given a radius, assuming at absolute fluxes</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unfinished</p>
</div>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.trim">
<code class="descname">trim</code><span class="sig-paren">(</span><em>range</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.trim" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Trims a spectrum to be within a certain wavelength range or set of ranges. Data outside of these ranges are excised from the wave, flux and noise arrays. The full spectrum can be restored with the reset() procedure.</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>range</strong> &#8211; the range(s) over which the spectrum is retained - a series of nested 2-element arrays</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothfluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="splat.Spectrum.waveRange">
<code class="descname">waveRange</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.Spectrum.waveRange" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Return the wavelength range of the current Spectrum object.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">2-element array giving minimum and maximum of wavelength range</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitwidth</span>
<span class="go">[&lt;Quantity 0.6447611451148987 micron&gt;, &lt;Quantity 2.5517737865448 micron&gt;]</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="splat-routines">
<h2>SPLAT Routines<a class="headerlink" href="#splat-routines" title="Permalink to this headline">¶</a></h2>
<div class="section" id="database-access">
<h3>Database Access<a class="headerlink" href="#database-access" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.getSpectrum">
<code class="descclassname">splat.</code><code class="descname">getSpectrum</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.getSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Gets a spectrum from the SPLAT library using various selection criteria. Calls <a class="reference external" href="api.html#splat_db.searchLibrary">searchLibrary</a> to select spectra; if any found it routines an array of Spectrum objects, otherwise an empty array.</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">An array of Spectrum objects that satisfy the search criteria</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Retrieving 1 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sparr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">spt</span><span class="o">=</span><span class="s1">&#39;M7&#39;</span><span class="p">)</span>
<span class="go">    Retrieving 120 files</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sparr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">spt</span><span class="o">=</span><span class="s1">&#39;T5&#39;</span><span class="p">,</span><span class="n">young</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    No files match search criteria</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.getStandard">
<code class="descclassname">splat.</code><code class="descname">getStandard</code><span class="sig-paren">(</span><em>spt</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.getStandard" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Gets one of the pre-defined spectral standards from the SPLAT library.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spt</strong> (<em>required</em>) &#8211; Spectral type of standard desired, either string (&#8216;M7&#8217;) or numberic (17)</li>
<li><strong>sd</strong> (<em>optional, default = False</em>) &#8211; Set to True to get a subdwarf standard</li>
<li><strong>esd</strong> (<em>optional, default = False</em>) &#8211; Set to True to get an extreme subdwarf standard</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getStandard</span><span class="p">(</span><span class="s1">&#39;M7&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Spectrum of VB 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sparr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getStandard</span><span class="p">(</span><span class="s1">&#39;T5&#39;</span><span class="p">,</span><span class="n">esd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Type esdT5.0 is not in esd standards: try one of the following:</span>
<span class="go">    [&#39;esdM5.0&#39;, &#39;esdM7.0&#39;, &#39;esdM8.5&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_db.keySource">
<code class="descclassname">splat_db.</code><code class="descname">keySource</code><span class="sig-paren">(</span><em>keys</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.keySource" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Takes a source key and returns a table with the source information</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>keys</strong> &#8211; source key or a list of source keys</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">keySource</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>
<span class="go">    SOURCE_KEY           NAME              DESIGNATION    ... NOTE SELECT</span>
<span class="go">    ---------- ------------------------ ----------------- ... ---- ------</span>
<span class="go">         10001 SDSS J000013.54+255418.6 J00001354+2554180 ...        True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">keySource</span><span class="p">([</span><span class="mi">10105</span><span class="p">,</span> <span class="mi">10623</span><span class="p">])</span>
<span class="go">    SOURCE_KEY          NAME             DESIGNATION    ... NOTE SELECT</span>
<span class="go">    ---------- ---------------------- ----------------- ... ---- ------</span>
<span class="go">         10105 2MASSI J0103320+193536 J01033203+1935361 ...        True</span>
<span class="go">         10623 SDSS J09002368+2539343 J09002368+2539343 ...        True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">keySource</span><span class="p">(</span><span class="mi">1000001</span><span class="p">)</span>
<span class="go">    No sources found with source key 1000001</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_db.keySpectrum">
<code class="descclassname">splat_db.</code><code class="descname">keySpectrum</code><span class="sig-paren">(</span><em>keys</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.keySpectrum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Takes a spectrum key and returns a table with the spectrum and source information</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>keys</strong> &#8211; spectrum key or a list of source keys</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">keySpectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>
<span class="go">    DATA_KEY SOURCE_KEY    DATA_FILE     ... COMPANION COMPANION_NAME NOTE_2</span>
<span class="go">    -------- ---------- ---------------- ... --------- -------------- ------</span>
<span class="go">       10001      10443 10001_10443.fits ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">keySpectrum</span><span class="p">([</span><span class="mi">10123</span><span class="p">,</span> <span class="mi">11298</span><span class="p">])</span>
<span class="go">    DATA_KEY SOURCE_KEY    DATA_FILE     ... COMPANION COMPANION_NAME NOTE_2</span>
<span class="go">    -------- ---------- ---------------- ... --------- -------------- ------</span>
<span class="go">       11298      10118 11298_10118.fits ...</span>
<span class="go">       10123      10145 10123_10145.fits ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">keySpectrum</span><span class="p">(</span><span class="mi">1000001</span><span class="p">)</span>
<span class="go">    No spectra found with spectrum key 1000001</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_db.searchLibrary">
<code class="descclassname">splat_db.</code><code class="descname">searchLibrary</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.searchLibrary" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Search the SpeX database to extract the key reference for that Spectrum</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>optional</em>) &#8211; search by source name (e.g., <code class="docutils literal"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">'Gliese</span> <span class="pre">570D'</span></code>)</li>
<li><strong>shortname</strong> (<em>optional</em>) &#8211; search be short name (e.g. <code class="docutils literal"><span class="pre">shortname</span> <span class="pre">=</span> <span class="pre">'J1457-2124'</span></code>)</li>
<li><strong>designation</strong> (<em>optional</em>) &#8211; search by full designation (e.g., <code class="docutils literal"><span class="pre">designation</span> <span class="pre">=</span> <span class="pre">'J11040127+1959217'</span></code>)</li>
<li><strong>coordinate</strong> (<em>optional</em>) &#8211; search around a coordinate by a radius specified by radius keyword (e.g., <code class="docutils literal"><span class="pre">coordinate</span> <span class="pre">=</span> <span class="pre">[180.,+30.],</span> <span class="pre">radius</span> <span class="pre">=</span> <span class="pre">10.</span></code>)</li>
<li><strong>radius</strong> (<em>optional, default = 10</em>) &#8211; search radius in arcseconds for coordinate search</li>
<li><strong>spt</strong> (<em>optional</em>) &#8211; search by SpeX spectral type; single value is exact, two-element array gives range (e.g., <code class="docutils literal"><span class="pre">spt</span> <span class="pre">=</span> <span class="pre">'M7'</span></code> or <code class="docutils literal"><span class="pre">spt</span> <span class="pre">=</span> <span class="pre">[24,39]</span></code>)</li>
<li><strong>spex_spt</strong> (<em>optional</em>) &#8211; same as <code class="docutils literal"><span class="pre">spt</span></code></li>
<li><strong>opt_spt</strong> (<em>optional</em>) &#8211; same as <code class="docutils literal"><span class="pre">spt</span></code> for literature optical spectral types</li>
<li><strong>nir_spt</strong> (<em>optional</em>) &#8211; same as <code class="docutils literal"><span class="pre">spt</span></code> for literature NIR spectral types</li>
<li><strong>jmag, hmag, kmag</strong> (<em>optional</em>) &#8211; select based on faint limit or range of J, H or Ks magnitudes (e.g., <code class="docutils literal"><span class="pre">jmag</span> <span class="pre">=</span> <span class="pre">[12,15]</span></code>)</li>
<li><strong>snr</strong> (<em>optional</em>) &#8211; search on minimum or range of S/N ratios (e.g., <code class="docutils literal"><span class="pre">snr</span> <span class="pre">=</span> <span class="pre">30.</span></code> or <code class="docutils literal"><span class="pre">snr</span> <span class="pre">=</span> <span class="pre">[50.,100.]</span></code>)</li>
<li><strong>subdwarf, young, binary, spbinary, red, blue, giant, wd, standard</strong> (<em>optional</em>) &#8211; classes to search on (e.g., <code class="docutils literal"><span class="pre">young</span> <span class="pre">=</span> <span class="pre">True</span></code>)</li>
<li><strong>logic</strong> (<em>optional, default = 'and'</em>) &#8211; search logic, can be <code class="docutils literal"><span class="pre">and</span></code> or <code class="docutils literal"><span class="pre">or</span></code></li>
<li><strong>combine</strong> (<em>optional, default = 'and'</em>) &#8211; same as logic</li>
<li><strong>date</strong> (<em>optional</em>) &#8211; search by date (e.g., <code class="docutils literal"><span class="pre">date</span> <span class="pre">=</span> <span class="pre">'20040322'</span></code>) or range of dates (e.g., <code class="docutils literal"><span class="pre">date=[20040301,20040330]</span></code>)</li>
<li><strong>reference</strong> (<em>optional</em>) &#8211; search by list of references (bibcodes) (e.g., <code class="docutils literal"><span class="pre">reference</span> <span class="pre">=</span> <span class="pre">'2011ApJS..197...19K'</span></code>)</li>
<li><strong>sort</strong> (<em>optional, default = True</em>) &#8211; sort results based on Right Ascension</li>
<li><strong>list</strong> (<em>optional, default = False</em>) &#8211; if True, return just a list of the data files (can be done with searchLibrary as well)</li>
<li><strong>lucky</strong> (<em>optional, default = False</em>) &#8211; if True, return one randomly selected spectrum from the selected sample</li>
<li><strong>output</strong> (<em>optional, default = 'all'</em>) &#8211; returns desired output of selected results</li>
<li><strong>logic</strong> &#8211; search logic, can be and`` or <code class="docutils literal"><span class="pre">or</span></code></li>
<li><strong>combine</strong> &#8211; same as logic</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">SearchLibrary</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;2213-2136&#39;</span><span class="p">)</span>
<span class="go">    DATA_KEY SOURCE_KEY    DATA_FILE     ... SHORTNAME  SELECT_2</span>
<span class="go">    -------- ---------- ---------------- ... ---------- --------</span>
<span class="go">       11590      11586 11590_11586.fits ... J2213-2136      1.0</span>
<span class="go">       11127      11586 11127_11586.fits ... J2213-2136      1.0</span>
<span class="go">       10697      11586 10697_11586.fits ... J2213-2136      1.0</span>
<span class="go">       10489      11586 10489_11586.fits ... J2213-2136      1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">SearchLibrary</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;2213-2136&#39;</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;OBSERVATION_DATE&#39;</span><span class="p">)</span>
<span class="go">    OBSERVATION_DATE</span>
<span class="go">    ----------------</span>
<span class="go">            20110908</span>
<span class="go">            20080829</span>
<span class="go">            20060902</span>
<span class="go">            20051017</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that this is currently only and AND search - need to figure out how to a full SQL style search</p>
</div>
</dd></dl>

</div>
<div class="section" id="spectral-comparison">
<h3>Spectral Comparison<a class="headerlink" href="#spectral-comparison" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.compareSpectra">
<code class="descclassname">splat.</code><code class="descname">compareSpectra</code><span class="sig-paren">(</span><em>sp1</em>, <em>sp2</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.compareSpectra" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Compare two spectra against each other using a pre-selected statistic. Returns the value of the desired statistic as well as the optimal scale factor. Minimum possible value for statistic is 1.e-9.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp1</strong> (<em>required</em>) &#8211; First spectrum class object, which sets the wavelength scale</li>
<li><strong>sp2</strong> (<em>required</em>) &#8211; Second spectrum class object, interpolated onto the wavelength scale of sp1</li>
<li><strong>statistic</strong> (<em>optional, default = 'chisqr'</em>) &#8211; <p>string defining which statistic to use in comparison; available options are:</p>
<ul>
<li><em>&#8216;chisqr&#8217;</em>: compare by computing chi squared value (requires spectra with noise values)</li>
<li><em>&#8216;stddev&#8217;</em>: compare by computing standard deviation</li>
<li><em>&#8216;stddev_norm&#8217;</em>: compare by computing normalized standard deviation</li>
<li><em>&#8216;absdev&#8217;</em>: compare by computing absolute deviation</li>
</ul>
</li>
<li><strong>fit_ranges</strong> (<em>optional, default = [0.65,2.45]</em>) &#8211; 2-element array or nested array of 2-element arrays specifying the wavelength ranges to be used for the fit, assumed to be measured in microns. This is effectively the opposite of mask_ranges.</li>
<li><strong>weights</strong> (<em>optional, default = [1, ..., 1] for len(sp1.wave)</em>) &#8211; Array specifying the weights for individual wavelengths; must be an array with length equal to the wavelength scale of <code class="docutils literal"><span class="pre">sp1</span></code>; need not be normalized</li>
<li><strong>mask_ranges</strong> (<em>optional, default = None</em>) &#8211; Multi-vector array setting wavelength boundaries for masking data, assumed to be in microns</li>
<li><strong>mask</strong> (<em>optional, default = [0, ..., 0] for len(sp1.wave)</em>) &#8211; Array specifiying which wavelengths to mask; must be an array with length equal to the wavelength scale of <code class="docutils literal"><span class="pre">sp1</span></code> with only 0 (OK) or 1 (mask).</li>
<li><strong>mask_telluric</strong> (<em>optional, default = False</em>) &#8211; Set to True to mask pre-defined telluric absorption regions</li>
<li><strong>mask_standard</strong> (<em>optional, default = False</em>) &#8211; Like <code class="docutils literal"><span class="pre">mask_telluric</span></code>, with a slightly tighter cut of 0.80-2.35 micron</li>
<li><strong>novar2</strong> (<em>optional, default = True</em>) &#8211; Set to True to compute statistic without considering variance of <code class="docutils literal"><span class="pre">sp2</span></code></li>
<li><strong>plot</strong> (<em>optional, default = False</em>) &#8211; Set to True to plot <code class="docutils literal"><span class="pre">sp1</span></code> with scaled <code class="docutils literal"><span class="pre">sp2</span></code> and difference spectrum overlaid</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; Set to True to report things as you&#8217;re going along</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp1</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;2346-3153&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Retrieving 1 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp2</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;1421+1827&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Retrieving 1 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;chisqr&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 19927.74527822856&gt;, 0.94360732593223595)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;stddev&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 3.0237604611215705 erg2 / (cm4 micron2 s2)&gt;, 0.98180983971456637)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;absdev&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 32.99816249949072 erg / (cm2 micron s)&gt;, 0.98155779612333172)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;chisqr&#39;</span><span class="p">,</span> <span class="n">novar2</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 17071.690727945213&gt;, 0.94029474635786015)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.generateMask">
<code class="descclassname">splat.</code><code class="descname">generateMask</code><span class="sig-paren">(</span><em>wave</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.generateMask" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Generates a mask array based on wavelength vector and optional inputs on what to mask.</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body">A mask array, where 0 = OK and 1 = ignore</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="spectral-classification">
<h3>Spectral Classification<a class="headerlink" href="#spectral-classification" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.classifyByIndex">
<code class="descclassname">splat.</code><code class="descname">classifyByIndex</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.classifyByIndex" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Determine the spectral type and uncertainty for a spectrum based on indices. Makes use of published index-SpT relations from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001AJ....121.1710R">Reid et al. (2001)</a>; <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...552L.147T">Testi et al. (2001)</a>; <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...657..511A">Allers et al. (2007)</a>; and <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...659..655B">Burgasser (2007)</a>. Returns 2-element tuple containing spectral type (numeric or string) and uncertainty.</p>
<p>Required Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements.</td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>set</strong> &#8211; <p>named set of indices to measure and compute spectral type</p>
<ul>
<li><em>&#8216;burgasser&#8217;</em>: H2O-J, CH4-J, H2O-H, CH4-H, CH4-K from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...659..655B">Burgasser (2007)</a> (default)</li>
<li><em>&#8216;allers&#8217;</em>: H2O from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...657..511A">Allers et al. (2007)</a></li>
<li><em>&#8216;reid&#8217;</em>:H2O-A and H2O-B from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001AJ....121.1710R">Reid et al. (2001)</a></li>
<li><em>&#8216;testi&#8217;</em>: sHJ, sKJ, sH2O_J, sH2O_H1, sH2O_H2, sH2O_K from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...552L.147T">Testi et al. (2001)</a></li>
</ul>
</li>
<li><strong>string</strong> &#8211; return spectral type as a string using typeToNum (default = False)</li>
<li><strong>round</strong> &#8211; rounds off to nearest 0.5 subtypes (default = False)</li>
<li><strong>allmeasures</strong> &#8211; Set to True to return all of the index values and individual subtypes  (default = False)</li>
<li><strong>remeasure</strong> &#8211; force remeasurement of indices (default = True)</li>
<li><strong>nsamples</strong> &#8211; number of Monte Carlo samples for error computation (default = 100)</li>
<li><strong>nloop</strong> &#8211; number of testing loops to see if spectral type is within a certain range (default = 5)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spc</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;0559-1404&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyByIndex</span><span class="p">(</span><span class="n">spc</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;burgasser&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    (&#39;T4.5&#39;, 0.2562934083414341)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.classifyByStandard">
<code class="descclassname">splat.</code><code class="descname">classifyByStandard</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.classifyByStandard" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Determine the spectral type and uncertainty for a
spectrum by direct comparison to defined spectral standards.
Dwarf standards span M0-T9 and include the standards listed in
<a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...637.1067B">Burgasser et al. (2006)</a>, <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a> and <a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJ...743...50C">Cushing et al. (2011)</a>.
Comparison to subdwarf and extreme subdwarf standards may also be done.
Returns the best
match or an F-test weighted mean and uncertainty. There is an option
to follow the procedure of <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a>, fitting only in
the 0.9-1.4 micron region.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">A tuple listing the best match standard and uncertainty based on F-test weighting and systematic uncertainty of 0.5 subtypes</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and
noise array elements.</li>
<li><strong>sp</strong> &#8211; required</li>
<li><strong>sptrange</strong> (<em>optional, default = ['M0','T9']</em>) &#8211; Set to the spectral type range over which comparisons should be made, can be a two-element array of strings or numbers</li>
<li><strong>statistic</strong> (<em>optional, default = 'chisqr'</em>) &#8211; <p>string defining which statistic to use in comparison; available options are:</p>
<ul>
<li><em>&#8216;chisqr&#8217;</em>: compare by computing chi squared value (requires spectra with noise values)</li>
<li><em>&#8216;stddev&#8217;</em>: compare by computing standard deviation</li>
<li><em>&#8216;stddev_norm&#8217;</em>: compare by computing normalized standard deviation</li>
<li><em>&#8216;absdev&#8217;</em>: compare by computing absolute deviation</li>
</ul>
</li>
<li><strong>method</strong> (<em>optional, default = ''</em>) &#8211; <p>set to <code class="docutils literal"><span class="pre">'kirkpatrick'</span></code> to follow the <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a> method, fitting only to the 0.9-1.4 micron band</p>
</li>
<li><strong>best</strong> (<em>optional, default = True</em>) &#8211; Set to True to return the best fit standard type</li>
<li><strong>average</strong> (<em>optional, default = False</em>) &#8211; Set to True to return an chi-square weighted type only</li>
<li><strong>compareto</strong> (<em>optional, default = None</em>) &#8211; Set to the single standard (string or number) you want to compare to</li>
<li><strong>plot</strong> (<em>optional, default = False</em>) &#8211; Set to True to generate a plot comparing best fit template to source; can also set keywords associated with <a href="#id90"><span class="problematic" id="id91">plotSpectrum_</span></a> routine</li>
<li><strong>string</strong> (<em>optional, default = True</em>) &#8211; return spectral type as a string</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; Set to True to give extra feedback</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Users can also set keyword parameters defined in <a href="#id92"><span class="problematic" id="id93">plotSpectrum_</span></a> and <a class="reference external" href="api.html#splat.compareSpectra">compareSpectra</a> routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Using dwarf standards</span>
<span class="go">    Type M3.0: statistic = 5763368.10355, scale = 0.000144521824721</span>
<span class="go">    Type M2.0: statistic = 5613862.67356, scale = 0.000406992798674</span>
<span class="go">    Type T8.0: statistic = 18949835.2087, scale = 9.70960919364</span>
<span class="go">    Type T9.0: statistic = 21591485.163, scale = 29.1529786804</span>
<span class="go">    Type L8.0: statistic = 3115605.62687, scale = 1.36392504072</span>
<span class="go">    Type L9.0: statistic = 2413450.79206, scale = 0.821131769522</span>
<span class="go">    ...</span>
<span class="go">    Best match to L1.0 spectral standard</span>
<span class="go">    Best spectral type = L1.0+/-0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">    (&#39;L1.0&#39;, 0.5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">average</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    (&#39;sdL0.0:&#39;, 1.8630159149200021)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.classifyByTemplate">
<code class="descclassname">splat.</code><code class="descname">classifyByTemplate</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.classifyByTemplate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Determine the spectral type and uncertainty for a
spectrum by direct comparison to a large set of spectra in
the library. Returns a dictionary with the best spectral type (F-test weighted mean and
uncertainty), and arrays for the N best-matching Spectrum objects, scale factors, spectral types and comparison statistics.
There is an option to follow the procedure of
<a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a>,
fitting only in the 0.9-1.4 micron region.
It is strongly encouraged that users winnow down the templates used in the comparison
by selecting templates using the <a class="reference external" href="api.html#splat_db.searchLibrary">searchLibrary</a> options or optionally the <code class="docutils literal"><span class="pre">set</span></code> parameter.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Output:</th><td class="field-body"><p class="first">A dictionary containing the following keys:</p>
<ul class="simple">
<li><strong>result</strong>: a tuple containing the spectral type and its uncertainty based on F-test statistic</li>
<li><strong>statistic</strong>: array of N best statistical comparison values</li>
<li><strong>scale</strong>: array of N best optimal scale factors</li>
<li><strong>spectra</strong>: array of N best Spectrum objects</li>
<li><strong>spt</strong>: array of N best spectral types</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and
noise array elements.</li>
<li><strong>sp</strong> &#8211; required</li>
<li><strong>statistic</strong> (<em>optional, default = 'chisqr'</em>) &#8211; <p>string defining which statistic to use in comparison; available options are:</p>
<ul>
<li><em>&#8216;chisqr&#8217;</em>: compare by computing chi squared value (requires spectra with noise values)</li>
<li><em>&#8216;stddev&#8217;</em>: compare by computing standard deviation</li>
<li><em>&#8216;stddev_norm&#8217;</em>: compare by computing normalized standard deviation</li>
<li><em>&#8216;absdev&#8217;</em>: compare by computing absolute deviation</li>
</ul>
</li>
<li><strong>select</strong> (<em>optional, default = ''</em>) &#8211; <p>string defining which spectral template set you want to compare to; several options which can be combined:</p>
<ul>
<li><em>m dwarf</em>: fit to M dwarfs only</li>
<li><em>l dwarf</em>: fit to M dwarfs only</li>
<li><em>t dwarf</em>: fit to M dwarfs only</li>
<li><em>vlm</em>: fit to M7-T9 dwarfs</li>
<li><em>optical</em>: only optical classifications</li>
<li><em>high sn</em>: median S/N greater than 100</li>
<li><em>young</em>: only young/low surface gravity dwarfs</li>
<li><em>companion</em>: only companion dwarfs</li>
<li><em>subdwarf</em>: only subdwarfs</li>
<li><em>single</em>: only dwarfs not indicated a binaries</li>
<li><em>spectral binaries</em>: only dwarfs indicated to be spectral binaries</li>
<li><em>standard</em>: only spectral standards (Note: use <a class="reference external" href="api.html#splat.classifyByStandard">classifyByStandard</a> instead)</li>
</ul>
</li>
<li><strong>method</strong> (<em>optional, default = ''</em>) &#8211; <p>set to <code class="docutils literal"><span class="pre">'kirkpatrick'</span></code> to follow the <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a> method, fitting only to the 0.9-1.4 micron band</p>
</li>
<li><strong>best</strong> (<em>optional, default = False</em>) &#8211; Set to True to return only the best fit template type</li>
<li><strong>nbest</strong> (<em>optional, default = 1</em>) &#8211; Set to the number of best fitting spectra to return</li>
<li><strong>maxtemplates</strong> (<em>optional, default = 100</em>) &#8211; Set to the maximum number of templates that should be fit</li>
<li><strong>force</strong> (<em>optional, default = False</em>) &#8211; By default, classifyByTemplate won&#8217;t proceed if you have more than 100 templates; set this parameter to True to ignore that constraint</li>
<li><strong>plot</strong> (<em>optional, default = False</em>) &#8211; Set to True to generate a plot comparing best fit template to source; can also set keywords associated with <a href="#id94"><span class="problematic" id="id95">plotSpectrum_</span></a> routine</li>
<li><strong>string</strong> (<em>optional, default = True</em>) &#8211; return spectral type as a string</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; give lots of feedback</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Users can also set keyword parameters defined in <a href="#id96"><span class="problematic" id="id97">plotSpectrum_</span></a> and <a class="reference external" href="api.html#splat_db.searchLibrary">searchLibrary</a> routines</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByTemplate</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">spt</span><span class="o">=</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span><span class="mi">26</span><span class="p">],</span><span class="n">nbest</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">    Too many templates (171) for classifyByTemplate; set force=True to override this</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByTemplate</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">spt</span><span class="o">=</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span><span class="mi">26</span><span class="p">],</span><span class="n">snr</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">nbest</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">    Comparing to 98 templates</span>
<span class="go">    LHS 102B L5.0 10488.1100432 11.0947838116</span>
<span class="go">    2MASSI J0013578-223520 L4.0 7037.37441677 136.830522173</span>
<span class="go">    SDSS J001608.44-004302.3 L5.5 15468.6209466 274.797693706</span>
<span class="go">    2MASSI J0028394+150141 L4.5 63696.1897668 187.266152375</span>
<span class="go">    ...</span>
<span class="go">    Best match = DENIS-P J153941.96-052042.4 with spectral type L4:</span>
<span class="go">    Mean spectral type = L4.5+/-0.718078660103</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">    {&#39;result&#39;: (&#39;L4.5&#39;, 0.71807866010293797),</span>
<span class="go">     &#39;scale&#39;: [3.0379089778408642e-14,</span>
<span class="go">      96.534933767992072,</span>
<span class="go">      3.812718429200959,</span>
<span class="go">      2.9878801833735986e-14,</span>
<span class="go">      3.0353579048704484e-14],</span>
<span class="go">     &#39;spectra&#39;: [Spectrum of DENIS-P J153941.96-052042.4,</span>
<span class="go">      Spectrum of 2MASSI J0443058-320209,</span>
<span class="go">      Spectrum of SDSSp J053951.99-005902.0,</span>
<span class="go">      Spectrum of 2MASSI J1104012+195921,</span>
<span class="go">      Spectrum of 2MASS J17502484-0016151],</span>
<span class="go">     &#39;spt&#39;: [24.0, 25.0, 25.0, 24.0, 25.5],</span>
<span class="go">     &#39;statistic&#39;: [&lt;Quantity 2108.997879536768&gt;,</span>
<span class="go">      &lt;Quantity 2205.640664932956&gt;,</span>
<span class="go">      &lt;Quantity 2279.316858783139&gt;,</span>
<span class="go">      &lt;Quantity 2579.0089210846527&gt;,</span>
<span class="go">      &lt;Quantity 2684.003187310027&gt;]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.classifyGravity">
<code class="descclassname">splat.</code><code class="descname">classifyGravity</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.classifyGravity" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Determine the gravity classification of a brown dwarf using the method of <a class="reference external" href="http://adsabs.harvard.edu/abs/2013ApJ...772...79A">Allers &amp; Liu (2013)</a>.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> (<em>required</em>) &#8211; Spectrum class object, which should contain wave, flux and
noise array elements. Must be between M6.0 and L7.0.</li>
<li><strong>spt</strong> (<em>optional, default = False</em>) &#8211; spectral type of <code class="docutils literal"><span class="pre">sp</span></code>. Must be between M6.0 and L7.0</li>
<li><strong>indices</strong> (<em>optional, default = 'allers'</em>) &#8211; specify indices set using <code class="docutils literal"><span class="pre">measureIndexSet</span></code>.</li>
<li><strong>plot</strong> (<em>optional, default = False</em>) &#8211; Set to True to plot sources against closest dwarf spectral standard</li>
<li><strong>allscores</strong> (<em>optional, default = False</em>) &#8211; Set to True to return a dictionary containing the gravity scores from individual indices</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; Give feedback while computing</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">Either a string specifying the gravity classification or a dictionary specifying the gravity scores for each index</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyGravity</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="go">    FLD-G</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyGravity</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">allscores</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Gravity Classification:</span>
<span class="go">        SpT = L4.0</span>
<span class="go">        VO-z: 1.012+/-0.029 =&gt; 0.0</span>
<span class="go">        FeH-z: 1.299+/-0.031 =&gt; 1.0</span>
<span class="go">        H-cont: 0.859+/-0.032 =&gt; 0.0</span>
<span class="go">        KI-J: 1.114+/-0.038 =&gt; 1.0</span>
<span class="go">        Gravity Class = FLD-G</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">    {&#39;FeH-z&#39;: 1.0,</span>
<span class="go">     &#39;H-cont&#39;: 0.0,</span>
<span class="go">     &#39;KI-J&#39;: 1.0,</span>
<span class="go">     &#39;VO-z&#39;: 0.0,</span>
<span class="go">     &#39;gravity_class&#39;: &#39;FLD-G&#39;,</span>
<span class="go">     &#39;score&#39;: 0.5,</span>
<span class="go">     &#39;spt&#39;: &#39;L4.0&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.initiateStandards">
<code class="descclassname">splat.</code><code class="descname">initiateStandards</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.initiateStandards" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Initiates the spectral standards in the SpeX library. By default this loads the dwarfs standards, but you can also specify loading of subdwarf and extreme subdwarf standards as well. Once loaded, these standards remain in memory.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sd</strong> (<em>optional, default = False</em>) &#8211; Set equal to True to load subdwarf standards</li>
<li><strong>esd</strong> (<em>optional, default = False</em>) &#8211; Set equal to True to load extreme subdwarf standards</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">initiateStandards</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">SPEX_STDS</span><span class="p">[</span><span class="s1">&#39;M5.0&#39;</span><span class="p">]</span>
<span class="go">Spectrum of Gl51</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.metallicity">
<code class="descclassname">splat.</code><code class="descname">metallicity</code><span class="sig-paren">(</span><em>sp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.metallicity" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Metallicity measurement using Na I and Ca I lines and H2O-K2 index as described in <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...748...93R">Rojas-Ayala et al.(2012)</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</li>
<li><strong>nsamples</strong> (<em>optional, default = 100</em>) &#8211; number of Monte Carlo samples for error computation</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;0559-1404&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">metallicity</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="go">    (-0.50726104530066363, 0.24844773591243882)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="spectrophotometry">
<h3>Spectrophotometry<a class="headerlink" href="#spectrophotometry" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.filterInfo">
<code class="descclassname">splat.</code><code class="descname">filterInfo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.filterInfo" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Prints out the current list of filters in the SPLAT reference library.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.filterMag">
<code class="descclassname">splat.</code><code class="descname">filterMag</code><span class="sig-paren">(</span><em>sp</em>, <em>filter</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.filterMag" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Determine the photometric magnitude of a source based on its
spectrum. Spectral fluxes are convolved with the filter profile specified by
the <code class="docutils literal"><span class="pre">filter</span></code> input.  By default this filter is also
convolved with a model of Vega to extract Vega magnitudes,
but the user can also specify AB magnitudes, photon flux or
energy flux.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> (<em>required</em>) &#8211; Spectrum class object, which should contain wave, flux and
noise array elements.</li>
<li><strong>filter</strong> (<em>required</em>) &#8211; String giving name of filter, which can either be one of the predefined filters listed in splat.FILTERS.keys() or a custom filter name</li>
<li><strong>custom</strong> (<em>optional, default = None</em>) &#8211; A 2 x N vector array specifying the wavelengths and transmissions for a custom filter</li>
<li><strong>notch</strong> (<em>optional, default = None</em>) &#8211; A 2 element array that specifies the lower and upper wavelengths for a notch filter (100% transmission within, 0% transmission without)</li>
<li><strong>vega</strong> (<em>optional, default = True</em>) &#8211; compute Vega magnitudes</li>
<li><strong>ab</strong> (<em>optional, default = False</em>) &#8211; compute AB magnitudes</li>
<li><strong>energy</strong> (<em>optional, default = False</em>) &#8211; compute energy flux</li>
<li><strong>photon</strong> (<em>optional, default = False</em>) &#8211; compute photon flux</li>
<li><strong>filterFolder</strong> (<em>optional, default = splat.FILTER_FOLDER</em>) &#8211; folder containing the filter transmission files</li>
<li><strong>vegaFile</strong> (<em>optional, default = vega_kurucz.txt</em>) &#8211; name of file containing Vega flux file, must be within <code class="docutils literal"><span class="pre">filterFolder</span></code></li>
<li><strong>nsamples</strong> (<em>optional, default = 100</em>) &#8211; number of samples to use in Monte Carlo error estimation</li>
<li><strong>info</strong> (<em>optional, default = False</em>) &#8211; List the predefined filter names available</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">14.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">filterMag</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="s1">&#39;MKO J&#39;</span><span class="p">)</span>
<span class="go">    (14.345894376898123, 0.027596454828421831)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.filterProperties">
<code class="descclassname">splat.</code><code class="descname">filterProperties</code><span class="sig-paren">(</span><em>filter</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.filterProperties" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Returns a dictionary containing key parameters for a particular filter.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filter</strong> (<em>required</em>) &#8211; name of filter, must be one of the specifed filters given by splat.FILTERS.keys()</li>
<li><strong>verbose</strong> (<em>optional, default = True</em>) &#8211; print out information about filter to screen</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">filterProperties</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go">Filter 2MASS J: 2MASS J-band</span>
<span class="go">Zeropoint = 1594.0 Jy</span>
<span class="go">Pivot point: = 1.252 micron</span>
<span class="go">FWHM = 0.323 micron</span>
<span class="go">Wavelength range = 1.066 to 1.442 micron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">filterProperties</span><span class="p">(</span><span class="s1">&#39;2MASS X&#39;</span><span class="p">)</span>
<span class="go">Filter 2MASS X not among the available filters:</span>
<span class="go">  2MASS H: 2MASS H-band</span>
<span class="go">  2MASS J: 2MASS J-band</span>
<span class="go">  2MASS KS: 2MASS Ks-band</span>
<span class="go">  BESSEL I: Bessel I-band</span>
<span class="go">  FOURSTAR H: FOURSTAR H-band</span>
<span class="go">  FOURSTAR H LONG: FOURSTAR H long</span>
<span class="go">  FOURSTAR H SHORT: FOURSTAR H short</span>
<span class="go">  ...</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="other-spectral-analyses">
<h3>Other Spectral Analyses<a class="headerlink" href="#other-spectral-analyses" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.measureIndex">
<code class="descclassname">splat.</code><code class="descname">measureIndex</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.measureIndex" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Measure an index on a spectrum based on defined methodology
measure method can be mean, median, integrate
index method can be ratio = 1/2, valley = 1-2/3, OTHERS
output is index value and uncertainty</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.measureIndexSet">
<code class="descclassname">splat.</code><code class="descname">measureIndexSet</code><span class="sig-paren">(</span><em>sp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.measureIndexSet" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Measures indices of <code class="docutils literal"><span class="pre">sp</span></code> from specified sets. Returns dictionary of indices.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</li>
<li><strong>set</strong> (<em>optional, default = 'burgasser'</em>) &#8211; <p>string defining which indices set you want to use; options include:</p>
<ul>
<li><em>bardalez</em>: H2O-J, CH4-J, H2O-H, CH4-H, H2O-K, CH4-K, K-J, H-dip, K-slope, J-slope, J-curve, H-bump, H2O-Y from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...794..143B">Bardalez Gagliuffi et al. (2014)</a></li>
<li><em>burgasser</em>: H2O-J, CH4-J, H2O-H, CH4-H, H2O-K, CH4-K, K-J from <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...637.1067B">Burgasser et al. (2006)</a></li>
<li><em>tokunaga</em>: K1, K2 from <a class="reference external" href="http://adsabs.harvard.edu/abs/1999AJ....117.1010T">Tokunaga &amp; Kobayashi (1999)</a></li>
<li><em>reid</em>: H2O-A, H2O-B from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001AJ....121.1710R">Reid et al. (2001)</a></li>
<li><em>geballe</em>: H2O-1.2, H2O-1.5, CH4-2.2 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2002ApJ...564..466G">Geballe et al. (2002)</a></li>
<li><em>allers</em>: H2O, FeH-z, VO-z, FeH-J, KI-J, H-cont from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...657..511A">Allers et al. (2007)</a>, <a class="reference external" href="http://adsabs.harvard.edu/abs/2013ApJ...772...79A">Allers &amp; Liu (2013)</a></li>
<li><em>testi</em>: sHJ, sKJ, sH2O-J, sH2O-H1, sH2O-H2, sH2O-K from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...552L.147T">Testi et al. (2001)</a></li>
<li><em>slesnick</em>: H2O-1, H2O-2, FeH from <a class="reference external" href="http://adsabs.harvard.edu/abs/2004ApJ...610.1045S">Slesnick et al. (2004)</a></li>
<li><em>mclean</em>: H2OD from <a class="reference external" href="http://adsabs.harvard.edu/abs/2003ApJ...596..561M">McLean et al. (2003)</a></li>
<li><em>rojas</em>: H2O-K2 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...748...93R">Rojas-Ayala et al.(2012)</a></li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1555+0954&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">measureIndexSet</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="s1">&#39;reid&#39;</span><span class="p">)</span>
<span class="go">    {&#39;H2O-B&#39;: (1.0531856077273236, 0.0045092074790538221), &#39;H2O-A&#39;: (0.89673318593633422, 0.0031278302105038594)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.measureEW">
<code class="descclassname">splat.</code><code class="descname">measureEW</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.measureEW" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Measures equivalent widths (EWs) of specified lines</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</li>
<li><strong>args</strong> &#8211; wavelength arrays. Needs at least two arrays to measure line and continuum regions.</li>
<li><strong>nonoise</strong> (<em>optional, default = ''</em>) &#8211; </li>
<li><strong>line</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.measureEWSet">
<code class="descclassname">splat.</code><code class="descname">measureEWSet</code><span class="sig-paren">(</span><em>sp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.measureEWSet" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Measures equivalent widths (EWs) of lines from specified sets. Returns dictionary of indices.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</li>
<li><strong>set</strong> (<em>optional, default = 'rojas'</em>) &#8211; <p>string defining which EW measurement set you want to use; options include:</p>
<ul>
<li><em>rojas</em>: EW measures from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...748...93R">Rojas-Ayala et al. (2012)</a>;
uses Na I 2.206/2.209 Ca I 2.26 micron lines.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1555+0954&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">measureEWSet</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="s1">&#39;rojas&#39;</span><span class="p">)</span>
<span class="go">    {&#39;Na I 2.206/2.209&#39;: (1.7484002652013144, 0.23332441577025356), &#39;Ca I 2.26&#39;: (1.3742491939667159, 0.24867705962337672), &#39;names&#39;: [&#39;Na I 2.206/2.209&#39;, &#39;Ca I 2.26&#39;], &#39;reference&#39;: &#39;EW measures from Rojas-Ayala et al. (2012)&#39;}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="empirical-relationships">
<h3>Empirical Relationships<a class="headerlink" href="#empirical-relationships" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.typeToColor">
<code class="descclassname">splat.</code><code class="descname">typeToColor</code><span class="sig-paren">(</span><em>spt</em>, <em>color</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.typeToColor" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Takes a spectral type and optionally a color (string) and returns the typical color of the source.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spt</strong> &#8211; string or integer of the spectral type</li>
<li><strong>color</strong> (<em>optional, default = 'J-K'</em>) &#8211; string indicating color; e.g., color=&#8217;i-z&#8217; (note that case does not matter)</li>
<li><strong>ref</strong> (<em>optional, default = 'dupuy'</em>) &#8211; <p>Abs Mag/SpT relation used to compute the absolute magnitude. Options are:</p>
<ul>
<li><em>skrzypek</em> (default): Color trends from <a class="reference external" href="http://adsabs.harvard.edu/abs/2015A%26A...574A..78S">Skryzpek et al. (2015)</a>.
Spectral type range is M5 to T8
Colors include i-z, z-Y, Y-J, J-H, H-K, K-W1, W1-W2, and combinations therein.</li>
</ul>
</li>
<li><strong>nsamples</strong> (<em>optional, default = 100</em>) &#8211; number of Monte Carlo samples for error computation</li>
<li><strong>unc</strong> (<em>optional, default = 0.</em>) &#8211; uncertainty of <code class="docutils literal"><span class="pre">spt</span></code>; if included, returns a tuple with color and uncertainty</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; Give feedback while in operation</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToColor</span><span class="p">(</span><span class="s1">&#39;L3&#39;</span><span class="p">,</span> <span class="s1">&#39;J-K&#39;</span><span class="p">)</span>
<span class="go">    (1.46, nan)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToColor</span><span class="p">(</span><span class="s1">&#39;M5&#39;</span><span class="p">,</span> <span class="s1">&#39;i-z&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;skrzypek&#39;</span><span class="p">,</span> <span class="n">unc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">    (0.91, 0.57797809947624645)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToColor</span><span class="p">(</span><span class="s1">&#39;M0&#39;</span><span class="p">,</span> <span class="s1">&#39;i-z&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;skrzypek&#39;</span><span class="p">)</span>
<span class="go">    Spectral type M0.0 is outside the range for reference set Skrzypek et al. (2015)</span>
<span class="go">    (nan, nan)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.typeToMag">
<code class="descclassname">splat.</code><code class="descname">typeToMag</code><span class="sig-paren">(</span><em>spt</em>, <em>filt</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.typeToMag" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Takes a spectral type and a filter, and returns absolute magnitude</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spt</strong> &#8211; string or integer of the spectral type</li>
<li><strong>filter</strong> &#8211; filter of the absolute magnitude. Options are MKO K, MKO H, MKO J, MKO Y, MKO LP, 2MASS J, 2MASS K, or 2MASS H</li>
<li><strong>nsamples</strong> (<em>optional, default = 100</em>) &#8211; number of Monte Carlo samples for error computation</li>
<li><strong>unc</strong> (<em>optional, default = 0.</em>) &#8211; uncertainty of <code class="docutils literal"><span class="pre">spt</span></code></li>
<li><strong>ref</strong> (<em>optional, default = 'dupuy'</em>) &#8211; <p>Abs Mag/SpT relation used to compute the absolute magnitude. Options are:</p>
<ul>
<li><em>burgasser</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...659..655B">Burgasser (2007)</a>.
Allowed spectral type range is L0 to T8, and allowed filters are MKO K.</li>
<li><em>faherty</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...752...56F">Faherty et al. (2012)</a>.
Allowed spectral type range is L0 to T8, and allowed filters are MKO J, MKO H and MKO K.</li>
<li><em>dupuy</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJS..201...19D">Dupuy &amp; Liu (2012)</a>.
Allowed spectral type range is M6 to T9, and allowed filters are MKO J, MKO Y, MKO H, MKO K, MKO LP, 2MASS J, 2MASS H, and 2MASS K.</li>
<li><em>filippazzo</em>: Abs Mag/SpT relation from Filippazzo et al. (2015). Allowed spectral type range is M6 to T9, and allowed filters are 2MASS J and WISE W2.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="s1">&#39;L3&#39;</span><span class="p">,</span> <span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go">    (12.730064813273996, 0.4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;MKO K&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;burgasser&#39;</span><span class="p">)</span>
<span class="go">    (10.705292820099999, 0.26)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;faherty&#39;</span><span class="p">)</span>
<span class="go">    Invalid filter given for Abs Mag/SpT relation from Faherty et al. (2012)</span>
<span class="go">    (nan, nan)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="s1">&#39;M0&#39;</span><span class="p">,</span> <span class="s1">&#39;2MASS H&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;dupuy&#39;</span><span class="p">)</span>
<span class="go">    Spectral Type is out of range for Abs Mag/SpT relation from Dupuy &amp; Liu (2012) Abs Mag/SpT relation</span>
<span class="go">    (nan, nan)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.typeToTeff">
<code class="descclassname">splat.</code><code class="descname">typeToTeff</code><span class="sig-paren">(</span><em>input</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.typeToTeff" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Returns an effective temperature (Teff) and its uncertainty for a given spectral type</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input</strong> &#8211; Spectral type; can be a number or a string from 0 (K0) and 49.0 (Y9).</li>
<li><strong>uncertainty</strong> (<em>optional, default = 0.001</em>) &#8211; uncertainty of spectral type</li>
<li><strong>unc</strong> (<em>optional, default = 0.001</em>) &#8211; same as <code class="docutils literal"><span class="pre">uncertainty</span></code></li>
<li><strong>spt_e</strong> (<em>optional, default = 0.001</em>) &#8211; same as <code class="docutils literal"><span class="pre">uncertainty</span></code></li>
<li><strong>ref</strong> (<em>optional, default = 'stephens2009'</em>) &#8211; <p>Teff/SpT relation used to compute the effective temperature. Options are:</p>
<ul>
<li><em>golimowski</em>: Teff/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2004AJ....127.3516G">Golimowski et al. (2004)</a>.
Allowed spectral type range is M6 to T8.</li>
<li><em>looper</em>: Teff/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...685.1183L">Looper et al. (2008)</a>.
Allowed spectral type range is L0 to T8.</li>
<li><em>stephens</em>: Teff/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2009ApJ...702..154S">Stephens et al. (2009)</a>.
Allowed spectral type range is M6 to T8 and uses alternate coefficients for L3 to T8.</li>
<li><em>marocco</em>: Teff/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2013AJ....146..161M">Marocco et al. (2013)</a>.
Allowed spectral type range is M7 to T8.</li>
<li><em>filippazzo</em>: Teff/SpT relation from Filippazzo et al. (2015). Allowed spectral type range is M6 to T9.</li>
</ul>
</li>
<li><strong>set</strong> (<em>optional, default = 'stephens2009'</em>) &#8211; same as <code class="docutils literal"><span class="pre">ref</span></code></li>
<li><strong>method</strong> (<em>optional, default = 'stephens2009'</em>) &#8211; same as <code class="docutils literal"><span class="pre">ref</span></code></li>
<li><strong>nsamples</strong> (<em>optional, default = 100</em>) &#8211; number of samples to use in Monte Carlo error estimation</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToTeff</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">    (2233.4796740905499, 100.00007874571999)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToTeff</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">unc</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;golimowski&#39;</span><span class="p">)</span>
<span class="go">    (2305.7500497902788, 127.62548366132124)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.estimateDistance">
<code class="descclassname">splat.</code><code class="descname">estimateDistance</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.estimateDistance" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Takes the apparent magnitude and either takes or determines the absolute
magnitude, then uses the magnitude/distance relation to estimate the
distance to the object in parsecs. Returns estimated distance and
uncertainty in parsecs</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> &#8211; Spectrum class object, which should be flux calibrated to its empirical apparent magnitude</li>
<li><strong>mag</strong> (<em>optional, default = False</em>) &#8211; apparent magnitude of <code class="docutils literal"><span class="pre">sp</span></code></li>
<li><strong>mag_unc</strong> (<em>optional, default = 0</em>) &#8211; uncertainty of the apparent magnitude</li>
<li><strong>absmag</strong> (<em>optional, default = False</em>) &#8211; absolute magnitude of <code class="docutils literal"><span class="pre">sp</span></code></li>
<li><strong>absmag_unc</strong> (<em>optional, default = 0</em>) &#8211; uncertainty of the absolute magnitude</li>
<li><strong>spt</strong> (<em>optional, default = False</em>) &#8211; spectral type of <code class="docutils literal"><span class="pre">sp</span></code></li>
<li><strong>spt_e</strong> (<em>optional, default = 0</em>) &#8211; uncertainty of the spectral type</li>
<li><strong>nsamples</strong> (<em>optional, default = 100</em>) &#8211; number of samples to use in Monte Carlo error estimation</li>
<li><strong>filter</strong> (<em>optional, default = False</em>) &#8211; <p>Name of filter, must be one of the following:</p>
<ul>
<li>&#8216;2MASS J&#8217;, &#8216;2MASS H&#8217;, &#8216;2MASS Ks&#8217;</li>
<li>&#8216;MKO J&#8217;, &#8216;MKO H&#8217;, &#8216;MKO K&#8217;, MKO Kp&#8217;, &#8216;MKO Ks&#8217;</li>
<li>&#8216;NICMOS F090M&#8217;, &#8216;NICMOS F095N&#8217;, &#8216;NICMOS F097N&#8217;, &#8216;NICMOS F108N&#8217;</li>
<li>&#8216;NICMOS F110M&#8217;, &#8216;NICMOS F110W&#8217;, &#8216;NICMOS F113N&#8217;, &#8216;NICMOS F140W&#8217;</li>
<li>&#8216;NICMOS F145M&#8217;, &#8216;NICMOS F160W&#8217;, &#8216;NICMOS F164N&#8217;, &#8216;NICMOS F165M&#8217;</li>
<li>&#8216;NICMOS F166N&#8217;, &#8216;NICMOS F170M&#8217;, &#8216;NICMOS F187N&#8217;, &#8216;NICMOS F190N&#8217;</li>
<li>&#8216;NIRC2 J&#8217;, &#8216;NIRC2 H&#8217;, &#8216;NIRC2 Kp&#8217;, &#8216;NIRC2 Ks&#8217;</li>
<li>&#8216;WIRC J&#8217;, &#8216;WIRC H&#8217;, &#8216;WIRC K&#8217;, &#8216;WIRC CH4S&#8217;, &#8216;WIRC CH4L&#8217;</li>
<li>&#8216;WIRC CO&#8217;, &#8216;WIRC PaBeta&#8217;, &#8216;WIRC BrGamma&#8217;, &#8216;WIRC Fe2&#8217;</li>
<li>&#8216;WISE W1&#8217;, &#8216;WISE W2&#8217;</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1555+0954&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">estimateDistance</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="go">    Please specify the filter used to determine the apparent magnitude</span>
<span class="go">    (nan, nan)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">estimateDistance</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">mag</span> <span class="o">=</span> <span class="mf">12.521</span><span class="p">,</span> <span class="n">mag_unc</span> <span class="o">=</span> <span class="mf">0.022</span><span class="p">,</span> <span class="n">absmag</span> <span class="o">=</span> <span class="mf">7.24</span><span class="p">,</span> <span class="n">absmag_unc</span> <span class="o">=</span> <span class="mf">0.50</span><span class="p">,</span> <span class="n">spt</span> <span class="o">=</span> <span class="s1">&#39;M3&#39;</span><span class="p">)</span>
<span class="go">    (116.36999172188771, 33.124820555524224)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="conversion-routines">
<h3>Conversion Routines<a class="headerlink" href="#conversion-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.caldateToDate">
<code class="descclassname">splat.</code><code class="descname">caldateToDate</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.caldateToDate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Convert from numeric date to calendar date, and vice-versa.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>d</strong> &#8211; A numeric date of the format &#8216;20050412&#8217;, or a date in the
calendar format &#8216;2005 Jun 12&#8217;</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">caldate</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">dateToCaldate</span><span class="p">(</span><span class="s1">&#39;20050612&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">caldate</span>
<span class="go">2005 Jun 12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">date</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">caldateToDate</span><span class="p">(</span><span class="s1">&#39;2005 June 12&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">date</span>
<span class="go">20050612</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.dateToCaldate">
<code class="descclassname">splat.</code><code class="descname">dateToCaldate</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.dateToCaldate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Converts numeric date to calendar date</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>date</strong> &#8211; String in the form &#8216;YYYYMMDD&#8217;</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">Date in format YYYY MMM DD</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">dateToCaldate</span><span class="p">(</span><span class="s1">&#39;19940523&#39;</span><span class="p">)</span>
<span class="go">    1994 May 23</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.coordinateToDesignation">
<code class="descclassname">splat.</code><code class="descname">coordinateToDesignation</code><span class="sig-paren">(</span><em>c</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.coordinateToDesignation" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Converts right ascension and declination into a designation string</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>c</strong> &#8211; RA and Dec coordinate to be converted; can be a SkyCoord object with units of degrees,
a list with RA and Dec in degrees, or a string with RA measured in hour
angles and Dec in degrees</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">Designation string</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="k">import</span> <span class="n">SkyCoord</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">238.86</span><span class="p">,</span> <span class="mf">9.90</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">    J15552640+0954000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">([</span><span class="mf">238.86</span><span class="p">,</span> <span class="mf">9.90</span><span class="p">])</span>
<span class="go">    J15552640+0954000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">(</span><span class="s1">&#39;15:55:26.4 +09:54:00.0&#39;</span><span class="p">)</span>
<span class="go">    J15552640+0954000</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.designationToCoordinate">
<code class="descclassname">splat.</code><code class="descname">designationToCoordinate</code><span class="sig-paren">(</span><em>value</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.designationToCoordinate" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Convert a designation srtring into a RA, Dec tuple or ICRS SkyCoord objects (default)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<em>required</em>) &#8211; Designation string with RA measured in hour angles and Dec in degrees</li>
<li><strong>icrs</strong> (<em>optional, defualt = True</em>) &#8211; returns astropy SkyCoord coordinate in ICRS frame if <code class="docutils literal"><span class="pre">True</span></code></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">Coordinate, either as [RA, Dec] or SkyCoord object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">designationToCoordinate</span><span class="p">(</span><span class="s1">&#39;J1555264+0954120&#39;</span><span class="p">)</span>
<span class="go">&lt;SkyCoord (ICRS): (ra, dec) in deg</span>
<span class="go">    (238.8585, 9.90333333)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.designationToShortName">
<code class="descclassname">splat.</code><code class="descname">designationToShortName</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.designationToShortName" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Produce a shortened version of designation</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>required</em>) &#8211; Designation string with RA measured in hour angles and Dec in degrees</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">Shorthand designation string</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">designationToShortName</span><span class="p">(</span><span class="s1">&#39;J1555264+0954120&#39;</span><span class="p">)</span>
<span class="go">    J1555+0954</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.typeToNum">
<code class="descclassname">splat.</code><code class="descname">typeToNum</code><span class="sig-paren">(</span><em>inp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.typeToNum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Converts between string and numeric spectral types, and vise versa.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input</strong> &#8211; Spectral type to convert. Can convert a number or a string from 0 (K0) and 49.0 (Y9).</li>
<li><strong>error</strong> (<em>optional, default = ''</em>) &#8211; magnitude of uncertainty. &#8216;:&#8217; for uncertainty &gt; 1 and &#8216;::&#8217; for uncertainty &gt; 2.</li>
<li><strong>uncertainty</strong> (<em>optional, default = 0</em>) &#8211; uncertainty of spectral type</li>
<li><strong>subclass</strong> (<em>optional, default = ''</em>) &#8211; <p>subclass of object. Options include:</p>
<ul>
<li><em>sd</em>: object is a subdwarf</li>
<li><em>esd</em>: object is an extreme subdwarf</li>
<li><em>usd</em>: object is an ultra subdwarf</li>
</ul>
</li>
<li><strong>lumclass</strong> (<em>optional, default = ''</em>) &#8211; luminosity class of object represented by roman numerals</li>
<li><strong>ageclass</strong> (<em>optional, default = ''</em>) &#8211; age class of object</li>
<li><strong>colorclass</strong> (<em>optional, default = ''</em>) &#8211; color class of object</li>
<li><strong>peculiar</strong> (<em>optional, default = False</em>) &#8211; if object is peculiar or not</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">    T0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="s1">&#39;T0.0&#39;</span><span class="p">)</span>
<span class="go">    30.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="n">peculiar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">lumclass</span> <span class="o">=</span> <span class="s1">&#39;II&#39;</span><span class="p">)</span>
<span class="go">    L7.0IIp:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">    Spectral type number must be between 0 (K0) and 49.0 (Y9)</span>
<span class="go">    nan</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.properCoordinates">
<code class="descclassname">splat.</code><code class="descname">properCoordinates</code><span class="sig-paren">(</span><em>c</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.properCoordinates" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Converts various coordinate forms to the proper SkyCoord format. Convertible forms include lists and strings.</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>c</strong> &#8211; coordinate to be converted. Can be a list (ra, dec) or a string.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">([</span><span class="mf">104.79</span><span class="p">,</span> <span class="mf">25.06</span><span class="p">])</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;06:59:09.60 +25:03:36.0&#39;</span><span class="p">)</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J06590960+2503360&#39;</span><span class="p">)</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat.isNumber">
<code class="descclassname">splat.</code><code class="descname">isNumber</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.isNumber" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Checks if something is a number.</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<em>required</em>) &#8211; object to be checked</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body">True or False</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">    True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isNumber</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="plotting-routines">
<h3>Plotting Routines<a class="headerlink" href="#plotting-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat_plot.plotSpectrum">
<code class="descclassname">splat_plot.</code><code class="descname">plotSpectrum</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_plot.plotSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><code class="docutils literal"><span class="pre">Primary</span> <span class="pre">plotting</span> <span class="pre">program</span> <span class="pre">for</span> <span class="pre">Spectrum</span> <span class="pre">objects.</span></code></td>
</tr>
</tbody>
</table>
<p>:Input
Spectrum objects, either sequentially, in list, or in list of lists</p>
<blockquote>
<div><ul class="simple">
<li>Spec1, Spec2, ...: plot multiple spectra together, or separately if multiplot = True</li>
<li>[Spec1, Spec2, ...]: plot multiple spectra together, or separately if multiplot = True</li>
<li>[[Spec1, Spec2], [Spec3, Spec4], ..]: plot multiple sets of spectra (multiplot forced to be True)</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>title = &#8216;&#8217;</dt>
<dd>string giving plot title  - NOTE: THIS IS NOT WORKING</dd>
<dt>xrange = [0.85,2.42]:</dt>
<dd>plot range for wavelength axis</dd>
<dt>yrange = [-0.02,1.2]*fluxMax:</dt>
<dd>plot range for wavelength axis</dd>
<dt>xlabel:</dt>
<dd>wavelength axis label; by default set by wlabel and wunit keywords in first spectrum object</dd>
<dt>ylabel:</dt>
<dd>flux axis label; by default set by fscale, flabel and funit keywords in first spectrum object</dd>
<dt>features:</dt>
<dd>a list of strings indicating chemical features to label on the spectra
options include H2O, CH4, CO, TiO, VO, FeH, H2, HI, KI, NaI, SB (for spectral binary)</dd>
<dt>mdwarf, ldwarf, tdwarf, young, binary = False:</dt>
<dd>add in features characteristic of these classes</dd>
<dt>telluric = False:</dt>
<dd>mark telluric absorption features</dd>
<dt>legend, legends, label or labels:</dt>
<dd>list of strings providing legend-style labels for each spectrum plotted</dd>
<dt>legendLocation or labelLocation = &#8216;upper right&#8217;:</dt>
<dd>place of legend; options are &#8216;upper left&#8217;, &#8216;center middle&#8217;, &#8216;lower right&#8217; (variations thereof) and &#8216;outside&#8217;</dd>
<dt>legendfontscale = 1:</dt>
<dd>sets the scale factor for the legend fontsize (defaults to fontscale)</dd>
<dt>grid = False:</dt>
<dd>add a grid</dd>
<dt>stack = 0:</dt>
<dd>set to a numerical offset to stack spectra on top of each other</dd>
<dt>zeropoint = [0,...]:</dt>
<dd>list of offsets for each spectrum, giving finer control than stack</dd>
<dt>showZero = True:</dt>
<dd>plot the zeropoint(s) of the spectra</dd>
<dt>comparison:</dt>
<dd>a comparison Spectrum to compare in each plot, useful for common reference standard</dd>
<dt>noise, showNoise or uncertainty = False:</dt>
<dd>plot the uncertainty for each spectrum</dd>
<dt>residual = False:</dt>
<dd>plots the residual between two spectra</dd>
<dt>color or colors:</dt>
<dd>color of plot lines; by default all black</dd>
<dt>colorUnc or colorsUnc:</dt>
<dd>color of uncertainty lines; by default same as line color but reduced opacity</dd>
<dt>colorScheme or colorMap:</dt>
<dd>color map to apply based on matplotlib colormaps;
see <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html?highlight=colormaps#matplotlib.pyplot.colormaps">http://matplotlib.org/api/pyplot_summary.html?highlight=colormaps#matplotlib.pyplot.colormaps</a></dd>
<dt>linestyle:</dt>
<dd>line style of plot lines; by default all solid</dd>
<dt>fontscale = 1:</dt>
<dd>sets a scale factor for the fontsize</dd>
<dt>inset = False:</dt>
<dd>place an inset panel showing a close up region of the spectral data</dd>
<dt>inset_xrange = False:</dt>
<dd>wavelength range for inset panel</dd>
<dt>inset_position = [0.65,0.60,0.20,0.20]</dt>
<dd>position of inset planet in normalized units, in order left, bottom, width, height</dd>
<dt>inset_features = False</dt>
<dd>list of features to label in inset plot</dd>
<dt>file or filename or output:</dt>
<dd>filename or filename base for output</dd>
<dt>filetype = &#8216;pdf&#8217;:</dt>
<dd>output filetype, generally determined from filename</dd>
<dt>multiplot = False:</dt>
<dd>creates multiple plots, depending on format of input (optional)</dd>
<dt>multipage = False:</dt>
<dd>spreads plots across multiple pages; output file format must be PDF
if not set and plots span multiple pages, these pages are output sequentially as separate files</dd>
<dt>layout or multilayout = [1,1]:</dt>
<dd>defines how multiple plots are laid out on a page</dd>
<dt>figsize:</dt>
<dd>set the figure size; set to default size if not indicated</dd>
<dt>interactive = False:</dt>
<dd>if plotting to window, set this to make window interactive</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example 1:</th><td class="field-body"><p class="first">A simple view of a random spectrum
&gt;&gt;&gt; import splat
&gt;&gt;&gt; spc = splat.getSpectrum(spt = &#8216;T5&#8217;, lucky=True)[0]
&gt;&gt;&gt; spc.plot()                       # this automatically generates a &#8220;quicklook&#8221; plot
&gt;&gt;&gt; splat.plotSpectrum(spc)          # does the same thing
&gt;&gt;&gt; splat.plotSpectrum(spc,uncertainty=True,tdwarf=True)     # show the spectrum uncertainty and T dwarf absorption features</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example 2:</th><td class="field-body"><dl class="first docutils">
<dt>Viewing a set of spectra for a given object</dt>
<dd><p class="first last">In this case we&#8217;ll look at all of the spectra of TWA 30B in the library, sorted by year and compared to the first epoch data
This is an example of using multiplot and multipage</p>
</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">splist</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;TWA 30B&#39;</span><span class="p">)</span>         <span class="c1"># get all spectra of TWA 30B</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">junk</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">splist</span><span class="p">]</span>             <span class="c1"># normalize the spectra</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">date</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">splist</span><span class="p">]</span>                   <span class="c1"># observation dates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spsort</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">splis</span><span class="p">))]</span>   <span class="c1"># sort spectra by dates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>                                         <span class="c1"># don&#39;t forget to sort dates!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">plotSpectrum</span><span class="p">(</span><span class="n">spsort</span><span class="p">,</span><span class="n">multiplot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">layout</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">multipage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\   <span class="c1"># here&#39;s our plot statement</span>
<span class="go">    comparison=spsort[0],uncertainty=True,mdwarf=True,telluric=True,legends=dates,           legendLocation=&#39;lower left&#39;,output=&#39;TWA30B.pdf&#39;)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example 3:</th><td class="field-body"><dl class="first docutils">
<dt>Display the spectra sequence of L dwarfs</dt>
<dd><p class="first last">This example uses the list of standard files contained in SPLAT, and illustrates the stack feature</p>
</dd>
</dl>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spt</span> <span class="o">=</span> <span class="p">[</span><span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">20</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="c1"># generate list of L spectral types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">initiateStandards</span><span class="p">()</span>                        <span class="c1"># initiate standards</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splist</span> <span class="o">=</span> <span class="p">[</span><span class="n">splat</span><span class="o">.</span><span class="n">SPEX_STDS</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spt</span><span class="p">]</span>       <span class="c1"># extact just L dwarfs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">junk</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">splist</span><span class="p">]</span>         <span class="c1"># normalize the spectra</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">shortname</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">splist</span><span class="p">]</span>         <span class="c1"># set labels to be names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">plotSpectrum</span><span class="p">(</span><span class="n">splist</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="n">stack</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>\  <span class="c1"># here&#39;s our plot statement</span>
<span class="go">    colorScheme=&#39;copper&#39;,legendLocation=&#39;outside&#39;,telluric=True,output=&#39;lstandards.pdf&#39;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat_plot.plotBatch">
<code class="descclassname">splat_plot.</code><code class="descname">plotBatch</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_plot.plotBatch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Plots a batch of spectra into a 2x2 set of PDF files, with options of overplotting comparison spectra, including best-match spectral standards.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input</strong> (<em>required</em>) &#8211; A single or list of Spectrum objects or filenames, or the glob search string for a set of files (e.g., &#8216;/Data/myspectra/<a href="#id22"><span class="problematic" id="id23">*</span></a>.fits&#8217;).</li>
<li><strong>output</strong> (<em>optional, default = 'spectra_plot.pdf'</em>) &#8211; Filename for PDF file output; full path should be include if not saving to current directory</li>
<li><strong>comparisons</strong> (<em>optional, default = None</em>) &#8211; list of Spectrum objects or filenames for comparison spectra. If comparisons list is shorter than source list, then last comparison source will be repeated. If the comparisons list is longer, the list will be truncated.</li>
<li><strong>classify</strong> (<em>optional, default = False</em>) &#8211; <p>Set to True to classify sources based on comparison to MLT spectral standards following the method of <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a>. This option normalizes the spectra by default</p>
</li>
<li><strong>normalize</strong> (<em>optional, default = False</em>) &#8211; Set to True to normalize source and (if passed) comparison spectra.</li>
<li><strong>legend</strong> (<em>optional, default = displays file name for source and object name for comparison (if passed)</em>) &#8211; Set to list of legends for plots. The number of legends should equal the number of sources and comparisons (if passed) in an alternating sequence. T</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Relevant parameters for plotSpectrum may also be passed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/home/mydata/*.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">(</span><span class="s1">&#39;/home/mydata/*.fits&#39;</span><span class="p">,</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">([</span><span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">],</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
<span class="go">All three of these commands produce the same result</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat_plot.plotSequence">
<code class="descclassname">splat_plot.</code><code class="descname">plotSequence</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_plot.plotSequence" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Compares a spectrum to a sequence of standards a batch of spectra into a 2x2 set of PDF files, with options of overplotting comparison spectra, including best-match spectral standards.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input</strong> (<em>required</em>) &#8211; A single or list of Spectrum objects or filenames, or the glob search string for a set of files (e.g., &#8216;/Data/myspectra/<a href="#id25"><span class="problematic" id="id26">*</span></a>.fits&#8217;).</li>
<li><strong>type_range</strong> (<em>optional, default = 2</em>) &#8211; Number of subtypes to consider above and below best-fit spectral type</li>
<li><strong>spt</strong> (<em>optional, default = None</em>) &#8211; Default spectral type for source; this input skips classifyByStandard</li>
<li><strong>output</strong> (<em>optional, default = None (screen display)</em>) &#8211; Filename for output; full path should be include if not saving to current directory. If blank, plot is shown on screen</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Relevant parameters for plotSpectrum may also be passed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/home/mydata/*.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">(</span><span class="s1">&#39;/home/mydata/*.fits&#39;</span><span class="p">,</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">([</span><span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">],</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
<span class="go">All three of these commands produce the same result</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat_plot.plotSED">
<code class="descclassname">splat_plot.</code><code class="descname">plotSED</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_plot.plotSED" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><code class="docutils literal"><span class="pre">Plot</span> <span class="pre">SED</span> <span class="pre">photometry</span> <span class="pre">with</span> <span class="pre">SpeX</span> <span class="pre">spectrum.</span></code></td>
</tr>
</tbody>
</table>
<p>Not currently implemented</p>
</dd></dl>

<dl class="function">
<dt id="splat_plot.plotIndices">
<code class="descclassname">splat_plot.</code><code class="descname">plotIndices</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_plot.plotIndices" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><code class="docutils literal"><span class="pre">Plot</span> <span class="pre">index-index</span> <span class="pre">plots.</span></code></td>
</tr>
</tbody>
</table>
<p>Not currently implemented</p>
</dd></dl>

</div>
<div class="section" id="utility-routines">
<h3>Utility Routines<a class="headerlink" href="#utility-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat.test">
<code class="descclassname">splat.</code><code class="descname">test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.test" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Tests the SPLAT Code</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Checks the following:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first last simple">
<li>If you are online and can see the SPLAT website</li>
<li>If you have access to unpublished spectra</li>
<li>If you can search for and load a spectrum</li>
<li>If <code class="docutils literal"><span class="pre">searchLibrary</span></code> functions properly</li>
<li>If index measurement routines functions properly</li>
<li>If classification routines function properly</li>
<li>If <code class="docutils literal"><span class="pre">typeToTeff</span></code> functions properly</li>
<li>If flux calibration and normalization function properly</li>
<li>If <code class="docutils literal"><span class="pre">loadModel</span></code> functions properly</li>
<li>If <code class="docutils literal"><span class="pre">compareSpectra</span></code> functions properly</li>
<li>If <code class="docutils literal"><span class="pre">plotSpectrum</span></code> functions properly</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.weightedMeanVar">
<code class="descclassname">splat.</code><code class="descname">weightedMeanVar</code><span class="sig-paren">(</span><em>vals</em>, <em>winp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.weightedMeanVar" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Computes weighted mean of an array of values through various methods. Returns weighted mean and weighted uncertainty.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vals</strong> &#8211; array of values</li>
<li><strong>winp</strong> &#8211; array of weights associated with <code class="docutils literal"><span class="pre">vals</span></code></li>
<li><strong>method</strong> (<em>optional, default = ''</em>) &#8211; <p>input type of weights. Default is where <code class="docutils literal"><span class="pre">winp</span></code> is the actual weights of <code class="docutils literal"><span class="pre">vals</span></code>. Options include:</p>
<ul>
<li><em>uncertainty</em>: uncertainty weighting, where <code class="docutils literal"><span class="pre">winp</span></code> is the uncertainties of <code class="docutils literal"><span class="pre">vals</span></code></li>
<li><em>ftest</em>: ftest weighting, where <code class="docutils literal"><span class="pre">winp</span></code> is the chi squared values of <code class="docutils literal"><span class="pre">vals</span></code></li>
</ul>
</li>
<li><strong>weight_minimum</strong> (<em>optional, default = 0.</em>) &#8211; minimum possible weight value</li>
<li><strong>dof</strong> (<em>optional, default = len(vals) - 1</em>) &#8211; effective degrees of freedom</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using <code class="docutils literal"><span class="pre">ftest</span></code> method, extra <code class="docutils literal"><span class="pre">dof</span></code> value is required</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">weightedMeanVar</span><span class="p">([</span><span class="mf">3.52</span><span class="p">,</span> <span class="mf">5.88</span><span class="p">,</span> <span class="mf">9.03</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">])</span>
<span class="go">    (5.0057009345794379, 4.3809422657000594)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">weightedMeanVar</span><span class="p">([</span><span class="mf">3.52</span><span class="p">,</span> <span class="mf">5.88</span><span class="p">,</span> <span class="mf">9.03</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.24</span><span class="p">,</span> <span class="mf">2.09</span><span class="p">,</span> <span class="mf">2.29</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;uncertainty&#39;</span><span class="p">)</span>
<span class="go">    (5.0069199363443841, 4.3914329968409946)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat.distributionStats">
<code class="descclassname">splat.</code><code class="descname">distributionStats</code><span class="sig-paren">(</span><em>x, q=[0.16, 0.5, 0.84], weights=None, sigma=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat.distributionStats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Find key values along distributions based on quantile steps.
This code is derived almost entirely from triangle.py.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="i-o-routines">
<h3>I/O Routines<a class="headerlink" href="#i-o-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat_db.checkOnline">
<code class="descclassname">splat_db.</code><code class="descname">checkOnline</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.checkOnline" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Checks if SPLAT&#8217;s URL is accessible from your machine&#8211;
that is, checks if you and the host are online. Alternately
checks if a given filename is present locally or online</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkOnline</span><span class="p">()</span>
<span class="go">True  # SPLAT&#39;s URL was detected.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkOnline</span><span class="p">()</span>
<span class="go">False # SPLAT&#39;s URL was not detected.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkOnline</span><span class="p">(</span><span class="s1">&#39;SpectralModels/BTSettl08/parameters.txt&#39;</span><span class="p">)</span>
<span class="go">&#39;&#39; # Could not find this online file.</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat_db.checkAccess">
<code class="descclassname">splat_db.</code><code class="descname">checkAccess</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.checkAccess" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Checks if user has access to unpublished spectra in SPLAT library.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">checkAccess</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Note:</th><td class="field-body"><p class="first last">Must have the file .splat_access in your home directory with the correct passcode to use.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat_db.checkFile">
<code class="descclassname">splat_db.</code><code class="descname">checkFile</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.checkFile" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Checks if a spectrum file exists in the SPLAT&#8217;s library.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> &#8211; A string containing the spectrum&#8217;s filename.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum1</span> <span class="o">=</span> <span class="s1">&#39;spex_prism_1315+2334_110404.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">checkFile</span><span class="p">(</span><span class="n">spectrum1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum2</span> <span class="o">=</span> <span class="s1">&#39;fake_name.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">checkFile</span><span class="p">(</span><span class="n">spectrum2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat_db.checkLocal">
<code class="descclassname">splat_db.</code><code class="descname">checkLocal</code><span class="sig-paren">(</span><em>inputfile</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.checkLocal" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Checks if a file is present locally or within the SPLAT
code directory</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkLocal</span><span class="p">(</span><span class="s1">&#39;splat.py&#39;</span><span class="p">)</span>
<span class="go">True  # found the code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkLocal</span><span class="p">(</span><span class="s1">&#39;parameters.txt&#39;</span><span class="p">)</span>
<span class="go">False  # can&#39;t find this file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkLocal</span><span class="p">(</span><span class="s1">&#39;SpectralModels/BTSettl08/parameters.txt&#39;</span><span class="p">)</span>
<span class="go">True  # found it</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="modeling-routines">
<h2>Modeling Routines<a class="headerlink" href="#modeling-routines" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spectral-modeling-routines">
<h3>Spectral Modeling Routines<a class="headerlink" href="#spectral-modeling-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat_model.loadModel">
<code class="descclassname">splat_model.</code><code class="descname">loadModel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_model.loadModel" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Purpose:</dt>
<dd>Loads up a model spectrum based on a set of input parameters. The models may be any one of the following listed below. For parameters between the model grid points, loadModel calls the function <a class="reference external" href="api.html#splat_model.loadInterpolatedModel">loadInterpolatedModel()</a>.</dd>
</dl>
<dl class="docutils">
<dt>Required Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body"><p class="first"><strong>model</strong>: The model set to use; may be one of the following:</p>
<ul class="last simple">
<li><em>BTSettl2008</em>: (default) model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012RSPTA.370.2765A">Allard et al. (2012)</a>  with effective temperatures of 400 to 2900 K (steps of 100 K); surface gravities of 3.5 to 5.5 in units of cm/s^2 (steps of 0.5 dex); and metallicity of -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.3, and 0.5 for temperatures greater than 2000 K only; cloud opacity is fixed in this model, and equilibrium chemistry is assumed. Note that this grid is not completely filled and some gaps have been interpolated (alternate designations: <cite>btsettled</cite>, <cite>btsettl</cite>, <cite>allard</cite>, <cite>allard12</cite>)</li>
<li><em>burrows06</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...640.1063B">Burrows et al. (2006)</a> with effective temperatures of 700 to 2000 K (steps of 50 K); surface gravities of 4.5 to 5.5 in units of cm/s^2 (steps of 0.1 dex); metallicity of -0.5, 0.0 and 0.5; and either no clouds or grain size 100 microns (fsed = &#8216;nc&#8217; or &#8216;f100&#8217;). equilibrium chemistry is assumed. Note that this grid is not completely filled and some gaps have been interpolated (alternate designations: <cite>burrows</cite>, <cite>burrows2006</cite>)</li>
<li><em>morley12</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...756..172M">Morley et al. (2012)</a> with effective temperatures of 400 to 1300 K (steps of 50 K); surface gravities of 4.0 to 5.5 in units of cm/s^2 (steps of 0.5 dex); and sedimentation efficiency (fsed) of 2, 3, 4 or 5; metallicity is fixed to solar, equilibrium chemistry is assumed, and there are no clouds associated with this model (alternate designations: <cite>morley2012</cite>)</li>
<li><em>morley14</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...787...78M">Morley et al. (2014)</a> with effective temperatures of 200 to 450 K (steps of 25 K) and surface gravities of 3.0 to 5.0 in units of cm/s^2 (steps of 0.5 dex); metallicity is fixed to solar, equilibrium chemistry is assumed, sedimentation efficiency is fixed at fsed = 5, and cloud coverage fixed at 50% (alternate designations: <cite>morley2014</cite>)</li>
<li><em>saumon12</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...750...74S">Saumon et al. (2012)</a> with effective temperatures of 400 to 1500 K (steps of 50 K); and surface gravities of 3.0 to 5.5 in units of cm/s^2 (steps of 0.5 dex); metallicity is fixed to solar, equilibrium chemistry is assumed, and no clouds are associated with these models (alternate designations: <cite>saumon</cite>, <cite>saumon2012</cite>)</li>
<li><em>drift</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011A%26A...529A..44W">Witte et al. (2011)</a> with effective temperatures of 1700 to 3000 K (steps of 50 K); surface gravities of 5.0 and 5.5 in units of cm/s^2; and metallicities of -3.0 to 0.0 (in steps of 0.5 dex); cloud opacity is fixed in this model, equilibrium chemistry is assumed (alternate designations: <cite>witte</cite>, <cite>witte2011</cite>, <cite>helling</cite>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd>
<dt>Optional Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body"><strong>teff</strong>: effective temperature of the model in K (e.g. <cite>teff</cite> = 1000)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body"><strong>logg</strong>: log10 of the surface gravity of the model in cm/s^2 units (e.g. <cite>logg</cite> = 5.0)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body"><strong>z</strong>: log10 of metallicity of the model relative to solar metallicity (e.g. <cite>z</cite> = -0.5)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body"><strong>fsed</strong>: sedimentation efficiency of the model (e.g. <cite>fsed</cite> = &#8216;f2&#8217;)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body"><strong>cld</strong>: cloud shape function of the model (e.g. <cite>cld</cite> = &#8216;f50&#8217;)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body"><strong>kzz</strong>: vertical eddy diffusion coefficient of the model (e.g. <cite>kzz</cite> = 2)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body"><strong>slit</strong>: slit weight of the model in arcseconds (e.g. <cite>slit</cite> = 0.3)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body"><strong>sed</strong>: if set to True, returns a broad-band spectrum spanning 0.3-30 micron (applies only for BTSettl2008 models with Teff &lt; 2000 K)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body"><strong>local</strong>: set to True to force program to read in local models (default = True)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body"><strong>online</strong>: set to True to force program to read in models from SPLAT webpage (default = False)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body"><strong>folder</strong>: string of the folder name containing the model set (default = &#8216;&#8217;)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body"><strong>filename</strong>: string of the filename of the desired model; should be a space-delimited file containing columns for wavelength (units of microns) and surface flux (F_lambda units of erg/cm^2/s/micron) (default = &#8216;&#8217;)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body"><strong>force</strong>: force the filename to be exactly as specified</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body"><strong>url</strong>: string of the url to the SPLAT website (default = &#8216;<a class="reference external" href="http://www.browndwarfs.org/splat/">http://www.browndwarfs.org/splat/</a>&#8216;)</td>
</tr>
</tbody>
</table>
</dd>
<dt>Output:</dt>
<dd>A SPLAT Spectrum object of the interpolated model with wavelength in microns and surface fluxes in F_lambda units of erg/cm^2/s/micron.</dd>
</dl>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="n">teff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">logg</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">    BTSettl2008 model with the following parmeters:</span>
<span class="go">    Teff = 1000 K</span>
<span class="go">    logg = 5.0 cm/s2</span>
<span class="go">    z = 0.0</span>
<span class="go">    fsed = nc</span>
<span class="go">    cld = nc</span>
<span class="go">    kzz = eq</span>
<span class="go">    Smoothed to slit width 0.5 arcseconds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="n">teff</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span><span class="n">logg</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;burrows&#39;</span><span class="p">)</span>
<span class="go">    Input value for teff = 2500 out of range for model set burrows06</span>
<span class="go">    Warning: Creating an empty Spectrum object</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_model.getModel">
<code class="descclassname">splat_model.</code><code class="descname">getModel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_model.getModel" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Purpose:</dt>
<dd>Redundant routine with <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a> to match syntax of <a class="reference external" href="api.html#splat.getSpectrum">getSpectrum()</a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="splat_model.loadInterpolatedModel">
<code class="descclassname">splat_model.</code><code class="descname">loadInterpolatedModel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_model.loadInterpolatedModel" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Purpose:</dt>
<dd>Generates as spectral model with is interpolated between model parameter grid points. This routine is called by <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a>, or it can be called on its own.</dd>
</dl>
<dl class="docutils">
<dt>Required Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param model:</th><td class="field-body">set of models to use; see options in <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a></td>
</tr>
</tbody>
</table>
</dd>
<dt>Optional Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">The parameters for <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a> can also be used here.</td>
</tr>
</tbody>
</table>
</dd>
<dt>Output:</dt>
<dd>A SPLAT Spectrum object of the interpolated model with wavelength in microns and surfae fluxes in F_lambda units of erg/cm^2/s/micron.</dd>
</dl>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="n">teff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">logg</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">    morley12 model with the following parmeters:</span>
<span class="go">    Teff = 540 K</span>
<span class="go">    logg = 4.7 cm/s2</span>
<span class="go">    z = 0.0</span>
<span class="go">    fsed = f3</span>
<span class="go">    cld = nc</span>
<span class="go">    kzz = eq</span>
<span class="go">    Smoothed to slit width 0.5 arcseconds</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_model.modelFitGrid">
<code class="descclassname">splat_model.</code><code class="descname">modelFitGrid</code><span class="sig-paren">(</span><em>spec</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_model.modelFitGrid" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Fits a spectrum to a grid of atmosphere models, reports the best-fit and weighted average parameters, and returns either a dictionary with the best-fit model parameters or the model itself scaled to the optimal scaling factor.</td>
</tr>
</tbody>
</table>
<p>If spectrum is absolutely flux calibrated with the <a class="reference external" href="api.html#splat.Spectrum.fluxCalibrate">fluxcalibrate()</a> method, the routine will also calculate the equivalent radii of the source.</p>
<p>Required inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spec</strong> &#8211; a Spectrum class object, which should contain wave, flux and noise array elements.</td>
</tr>
</tbody>
</table>
<p>Optional inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>model</strong> &#8211; set of models to use (<code class="docutils literal"><span class="pre">set</span></code> and <code class="docutils literal"><span class="pre">model_set</span></code> may also be used), from the available models given by <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a>.</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stat</strong> &#8211; the statistic to use for comparing models to spectrum; can be any one of the statistics allowed in <a class="reference external" href="api.html#splat.compareSpectra">compareSpectra()</a> routine (default = <cite>chisqr</cite>)</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>weights</strong> &#8211; an array of the same length as the spectrum flux array, specifying the weight for each pixel (default: equal weighting)</li>
<li><strong>mask</strong> &#8211; an array of the same length as the spectrum flux array, specifying which data to include in comparison statistic as coded by 0 = good data, 1 = bad (masked). The routine <a class="reference external" href="api.html#splat.generateMask">generateMask()</a> is called to create a mask, so parameters from that routine may be specified (default: no masking)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>compute_radius</strong> &#8211; if set to True, force the computation of the radius based on the model scaling factor. This is automatically set to True if the input spectrum is absolutely flux calibrated (default = False)</li>
<li><strong>teff_range</strong> &#8211; set to the range of temperatures over which model fitting will be done (<code class="docutils literal"><span class="pre">temperature_range</span></code> and <code class="docutils literal"><span class="pre">t_range</span></code> may also be used; default = full range of model temperatures)</li>
<li><strong>logg_range</strong> &#8211; set to the range of surface gravities over which model fitting will be done (<code class="docutils literal"><span class="pre">gravity_range</span></code> and <code class="docutils literal"><span class="pre">g_range</span></code> may also be used; default = full range of model temperatures)</li>
<li><strong>z_range</strong> &#8211; set to the range of metallicities over which model fitting will be done (<code class="docutils literal"><span class="pre">metallicity_range</span></code> may also be used; default = full range of model temperatures)</li>
<li><strong>return_model</strong> &#8211; set to True to return a Spectrum class of the best-fit model instead of a dictionary of parameters (default = False)</li>
<li><strong>return_mean_parameters</strong> &#8211; set to True a dictionary of mean parameters (default = False)</li>
<li><strong>return_all_parameters</strong> &#8211; set to True to return all of the parameter sets and fitting values (default = False)</li>
<li><strong>output</strong> &#8211; a string containing the base filename for outputs associated with this fitting routine (<code class="docutils literal"><span class="pre">file</span></code> and <code class="docutils literal"><span class="pre">filename</span></code> may also be used; default = &#8216;fit&#8217;)</li>
<li><strong>noPlot</strong> &#8211; set to True to suppress plotting outputs (default = False)</li>
<li><strong>plot_format</strong> &#8211; specifes the file format for output plots (default = <cite>pdf</cite>)</li>
<li><strong>file_best_comparison</strong> &#8211; filename to use for plotting spectrum vs. best-fit model (default = &#8216;<code class="docutils literal"><span class="pre">OUTPUT</span></code>_best_comparison.``PLOT_FORMAT``&#8217;)</li>
<li><strong>file_mean_comparison</strong> &#8211; filename to use for plotting spectrum vs. mean parameter model (default = &#8216;<code class="docutils literal"><span class="pre">OUTPUT</span></code>_mean_comparison.``PLOT_FORMAT``&#8217;)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>In addition, the parameters for <a class="reference external" href="api.html#splat.compareSpectra">compareSpectra()</a> , <a class="reference external" href="api.html#splat.generateMask">generateMask()</a> and <a class="reference external" href="api.html#splat_plot.plotSpectrum">plotSpectrum()</a> may be used; see SPLAT API for details.</p>
<p>Output:</p>
<p>Default output is a dictionary containing the best-fit model parameters: model name, teff, logg, z, fsed, kzz, cloud and slit, as well as the scaling factor for the model and comparison statistic.
If the input spectrum is absolutely flux calibrated, radius is also returned.  Alternate outputs include:</p>
<blockquote>
<div><ul class="simple">
<li>a dictionary of the statistic-weighted mean parameters (<code class="docutils literal"><span class="pre">return_mean_parameters</span></code> = True)</li>
<li>a list of dictionaries containing all parameters and fit statistics (<code class="docutils literal"><span class="pre">return_all_parameters</span></code> = True)</li>
<li>a Spectrum class of the best-fit model scaled to the best-fit scaling (<code class="docutils literal"><span class="pre">return_model</span></code> = True)</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">12.32</span><span class="p">,</span><span class="n">absolute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">modelFitGrid</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1200</span><span class="p">,</span><span class="mi">2500</span><span class="p">],</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;Saumon&#39;</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;fit1507&#39;</span><span class="p">)</span>
<span class="go">    Best Parameters to fit to BT-Settl (2008) models:</span>
<span class="go">        $T_{eff}$=1800.0 K</span>
<span class="go">        $log\ g$=5.0 dex(cm / s2)</span>
<span class="go">        $[M/H]$=-0.0 dex</span>
<span class="go">        $f_{sed}$=nc</span>
<span class="go">        $cld$=nc</span>
<span class="go">        $log\ \kappa_{zz}$=eq dex(cm2 / s)</span>
<span class="go">        R=0.143324498969 solRad</span>
<span class="go">        chi=4500.24997585</span>
<span class="go">    Mean Parameters:</span>
<span class="go">        $T_{eff}$: 1800.0+/-0.0 K</span>
<span class="go">        $log\ g$: 5.0+/-0.0 dex(cm / s2)</span>
<span class="go">        Radius: 0.143324498969+/-0.0 solRad</span>
<span class="go">        $[M/H]$: 0.0+/-0.0 dex</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_model.modelFitMCMC">
<code class="descclassname">splat_model.</code><code class="descname">modelFitMCMC</code><span class="sig-paren">(</span><em>spec</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_model.modelFitMCMC" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Uses Markov chain Monte Carlo method to compare an object with models from a
given set. Returns the best estimate of the effective temperature, surface
gravity, and metallicity. Can also determine the radius of the object by
using these estimates.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spec</strong> &#8211; Spectrum class object, which should contain wave, flux and
noise array elements.</li>
<li><strong>nsamples</strong> (<em>optional, default = 1000</em>) &#8211; number of Monte Carlo samples</li>
<li><strong>initial_cut</strong> (<em>optional, default = 0.1</em>) &#8211; the fraction of the initial steps to be discarded. (e.g., if
<code class="docutils literal"><span class="pre">initial_cut</span> <span class="pre">=</span> <span class="pre">0.2</span></code>, the first 20% of the samples are discarded.)</li>
<li><strong>burn</strong> (<em>optional, default = 0.1</em>) &#8211; the same as <code class="docutils literal"><span class="pre">initial_cut</span></code></li>
<li><strong>set</strong> (<em>optional, default = 'BTSettl2008'</em>) &#8211; <p>set of models to use; options include:</p>
<ul>
<li><em>&#8216;BTSettl2008&#8217;</em>: model set with effective temperature of 400 to 2900 K, surface gravity of 3.5 to 5.5 and metallicity of -3.0 to 0.5
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012RSPTA.370.2765A">Allard et al. (2012)</a></li>
<li><em>&#8216;burrows06&#8217;</em>: model set with effective temperature of 700 to 2000 K, surface gravity of 4.5 to 5.5, metallicity of -0.5 to 0.5,
and sedimentation efficiency of either 0 or 100 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...640.1063B">Burrows et al. (2006)</a></li>
<li><em>&#8216;morley12&#8217;</em>: model set with effective temperature of 400 to 1300 K, surface gravity of 4.0 to 5.5, metallicity of 0.0
and sedimentation efficiency of 2 to 5 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...756..172M">Morley et al. (2012)</a></li>
<li><em>&#8216;morley14&#8217;</em>: model set with effective temperature of 200 to 450 K, surface gravity of 3.0 to 5.0, metallicity of 0.0
and sedimentation efficiency of 5 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...787...78M">Morley et al. (2014)</a></li>
<li><em>&#8216;saumon12&#8217;</em>: model set with effective temperature of 400 to 1500 K, surface gravity of 3.0 to 5.5 and metallicity of 0.0
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...750...74S">Saumon et al. (2012)</a></li>
<li><em>&#8216;drift&#8217;</em>: model set with effective temperature of 1700 to 3000 K, surface gravity of 5.0 to 5.5 and metallicity of -3.0 to 0.0
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011A%26A...529A..44W">Witte et al. (2011)</a></li>
</ul>
</li>
<li><strong>model</strong> (<em>optional, default = 'BTSettl2008'</em>) &#8211; the same as <code class="docutils literal"><span class="pre">set</span></code></li>
<li><strong>models</strong> (<em>optional, default = 'BTSettl2008'</em>) &#8211; the same as <code class="docutils literal"><span class="pre">set</span></code></li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; give lots of feedback</li>
<li><strong>mask_ranges</strong> (<em>optional, default = []</em>) &#8211; mask any flux value of <code class="docutils literal"><span class="pre">spec</span></code> by specifying the wavelength range.
Must be in microns.</li>
<li><strong>mask_telluric</strong> (<em>optional, default = False</em>) &#8211; masks certain wavelengths to avoid effects from telluric absorption</li>
<li><strong>mask_standard</strong> (<em>optional, default = True</em>) &#8211; masks wavelengths below 0.8 and above 2.35 microns</li>
<li><strong>mask</strong> (<em>optional, default = [0, ..., 0] for len(sp1.wave)</em>) &#8211; mask any flux value of <code class="docutils literal"><span class="pre">spec</span></code>; has to be an array with length equal as <code class="docutils literal"><span class="pre">spec</span></code> with only 0 (unmask) or 1 (mask).</li>
<li><strong>radius</strong> (<em>optional</em>) &#8211; calculates and returns radius of object if True</li>
<li><strong>filename</strong> (<em>optional</em>) &#8211; filename or filename base for output</li>
<li><strong>filebase</strong> (<em>optional</em>) &#8211; the same as <code class="docutils literal"><span class="pre">filename</span></code></li>
<li><strong>savestep</strong> (optional, default = <code class="docutils literal"><span class="pre">nsamples/10</span></code>) &#8211; indicate when to save data output (e.g. <code class="docutils literal"><span class="pre">savestep</span> <span class="pre">=</span> <span class="pre">10</span></code> will save the output every 10 samples)</li>
<li><strong>dataformat</strong> (<em>optional, default = 'ascii.csv'</em>) &#8211; output data format type</li>
<li><strong>initial_guess</strong> (<em>optional, default = array of random numbers within allowed ranges</em>) &#8211; array including initial guess of the effective temperature, surface gravity and metallicity of <code class="docutils literal"><span class="pre">spec</span></code>.
Can also set individual guesses of spectral parameters by using <strong>initial_temperature</strong> or <strong>initial_teff</strong>,
<strong>initial_gravity</strong> or <strong>initial_logg</strong>, and <strong>initial_metallicity</strong> or <strong>initial_z</strong>.</li>
<li><strong>ranges</strong> (<em>optional, default = depends on model set</em>) &#8211; array of arrays indicating ranges of the effective temperature, surface gravity and metallicity of the model set.
Can also set individual ranges of spectral parameters by using <strong>temperature_range</strong> or <strong>teff_range</strong>,
<strong>gravity_range</strong> or <strong>logg_range</strong>, and <strong>metallicity_range</strong> or <strong>z_range</strong>.</li>
<li><strong>step_sizes</strong> (<em>optional, default = [50, 0.25, 0.1]</em>) &#8211; an array specifying step sizes of spectral parameters. Can also set individual step sizes by using
<strong>temperature_step</strong> or <strong>teff_step</strong>, <strong>gravity_step</strong> or <strong>logg_step</strong>, and <strong>metallicity_step</strong> or <strong>z_step</strong>.</li>
<li><strong>nonmetallicity</strong> (<em>optional, default = False</em>) &#8211; if True, sets metallicity = 0</li>
<li><strong>addon</strong> (<em>optional, default = False</em>) &#8211; reads in prior calculation and starts from there. Allowed object types are tables, dictionaries and strings.</li>
<li><strong>evolutionary_model</strong> (<em>optional, default = 'Baraffe'</em>) &#8211; <p>set of evolutionary models to use. See Brown Dwarf Evolutionary Models page for
more details. Options include:</p>
<ul>
<li><em>&#8216;baraffe&#8217;</em>: Evolutionary models from <a class="reference external" href="http://arxiv.org/abs/astro-ph/0302293">Baraffe et al. (2003)</a>.</li>
<li><em>&#8216;burrows&#8217;</em>: Evolutionary models from <a class="reference external" href="http://adsabs.harvard.edu/abs/1997ApJ...491..856B">Burrows et al. (1997)</a>.</li>
<li><em>&#8216;saumon&#8217;</em>: Evolutionary models from <a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...689.1327S">Saumon &amp; Marley (2008)</a>.</li>
</ul>
</li>
<li><strong>emodel</strong> (<em>optional, default = 'Baraffe'</em>) &#8211; the same as <code class="docutils literal"><span class="pre">evolutionary_model</span></code></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1047+2124&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>        <span class="c1"># T6.5 radio emitter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spt</span><span class="p">,</span> <span class="n">spt_e</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">spt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">,</span><span class="s1">&#39;T8&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teff</span><span class="p">,</span><span class="n">teff_e</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToTeff</span><span class="p">(</span><span class="n">spt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;MKO J&#39;</span><span class="p">,</span><span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="n">spt</span><span class="p">,</span><span class="s1">&#39;MKO J&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">absolute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">modelFitMCMC</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">mask_standard</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initial_guess</span><span class="o">=</span><span class="p">[</span><span class="n">teff</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">zstep</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">savestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Trouble with model BTSettl2008 T=1031.61, logg=5.27, z=-0.02</span>
<span class="go">    At cycle 0: fit = T=1031.61, logg=5.27, z=0.00 with chi2 = 35948.5</span>
<span class="go">    Trouble with model BTSettl2008 T=1031.61, logg=5.27, z=-0.13</span>
<span class="go">    At cycle 1: fit = T=1031.61, logg=5.27, z=0.00 with chi2 = 35948.5</span>
<span class="go">                                    .</span>
<span class="go">                                    .</span>
<span class="go">                                    .</span>
<span class="go">                        # Skipped a few lines</span>
<span class="go">                                    .</span>
<span class="go">                                    .</span>
<span class="go">                                    .</span>
<span class="go">    Trouble with model BTSettl2008 T=973.89, logg=4.95, z=-0.17</span>
<span class="go">    At cycle 99: fit = T=973.89, logg=4.95, z=0.00 with chi2 = 30569.6</span>

<span class="go">    Number of steps = 170</span>

<span class="go">    Best Fit parameters:</span>
<span class="go">    Lowest chi2 value = 29402.3750247 for 169.0 degrees of freedom</span>
<span class="go">    Effective Temperature = 1031.608 (K)</span>
<span class="go">    log Surface Gravity = 5.267</span>
<span class="go">    Metallicity = 0.000</span>
<span class="go">    Radius (relative to Sun) from surface fluxes = 0.103</span>

<span class="go">    Median parameters:</span>
<span class="go">    Effective Temperature = 1029.322 + 66.535 - 90.360 (K)</span>
<span class="go">    log Surface Gravity = 5.108 + 0.338 - 0.473</span>
<span class="go">    Metallicity = 0.000 + 0.000 - 0.000</span>
<span class="go">    Radius (relative to Sun) from surface fluxes = 0.094 + 0.012 - 0.007</span>


<span class="go">    fit_J1047+2124_BTSettl2008</span>
<span class="go">    Quantiles:</span>
<span class="go">    [(0.16, 0.087231370556002871), (0.5, 0.09414839610875167), (0.84, 0.10562967101117798)]</span>
<span class="go">    Quantiles:</span>
<span class="go">    [(0.16, 4.6366512070621884), (0.5, 5.1077094570511488), (0.84, 5.4459108887603094)]</span>
<span class="go">    Quantiles:</span>
<span class="go">    [(0.16, 938.96254520460286), (0.5, 1029.3222563137401), (0.84, 1095.8574021575118)]</span>

<span class="go">    Total time elapsed = 0:01:46.340169</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">table</span>
<span class="go">         teff          logg      z       radius         chisqr</span>
<span class="go">    ------------- ------------- --- --------------- -------------</span>
<span class="go">    1031.60790828 5.26704520744 0.0  0.103152256465 29402.3750247</span>
<span class="go">    1031.60790828 5.26704520744 0.0  0.103152256465 29402.3750247</span>
<span class="go">              ...           ... ...             ...           ...   # Skipped a few lines</span>
<span class="go">    938.962545205 5.43505121711 0.0  0.125429265207 43836.3720496</span>
<span class="go">    938.962545205 5.43505121711 0.0  0.129294090544 47650.4267022</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_model.modelFitEMCEE">
<code class="descclassname">splat_model.</code><code class="descname">modelFitEMCEE</code><span class="sig-paren">(</span><em>spec</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_model.modelFitEMCEE" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Uses the <code class="docutils literal"><span class="pre">emcee</span></code> package by Dan Foreman-Mackey et al. to perform
Goodman &amp; Weare&#8217;s Affine Invariant Markov chain Monte Carlo (MCMC) Ensemble sampler
to fit a spectrum to a set of atmosphere models.
Returns the best estimate of the effective temperature, surface
gravity, and (if selected) metallicity.  Includes an estimate of the time required to run, prompts
user if they want to proceed, and shows progress with iterative saving of outcomes</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spec</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements.</li>
<li><strong>nwalkers</strong> (<em>optional, default = 20</em>) &#8211; number of MCMC walkers, should have at least 20</li>
<li><strong>nsamples</strong> (<em>optional, default = 500</em>) &#8211; number of MCMC samples, for model fitting about 500 seems OK</li>
<li><strong>burn_fraction</strong> (<em>optional, default = 0.5</em>) &#8211; the fraction of the initial steps to be discarded. (e.g., if
<code class="docutils literal"><span class="pre">burn_fraction</span> <span class="pre">=</span> <span class="pre">0.2</span></code>, the first 20% of the samples are discarded.)</li>
<li><strong>initial_guess</strong> (<em>optional, default = array of random numbers within allowed ranges</em>) &#8211; array including initial guess of the model parameters.
Can also set individual guesses of spectral parameters by using
<strong>initial_temperature</strong>, <strong>initial_teff</strong>, or <strong>t0</strong>;
<strong>initial_gravity</strong>, <strong>initial_logg</strong> or <strong>g0</strong>;
and <strong>initial_metallicity</strong>, <strong>initial_z</strong> or <strong>z0</strong>.</li>
<li><strong>limits</strong> (<em>optional, default = depends on model set</em>) &#8211; list of 2-element arrays indicating ranges of the model parameters to limit the parameter space.
Can also set individual ranges of spectral parameters by using
<strong>temperature_range</strong>, <strong>teff_range</strong> or <strong>t_range</strong>;
<strong>gravity_range</strong>, <strong>logg_range</strong> or <strong>g_range</strong>;
and <strong>metallicity_range</strong> or <strong>z_range</strong>.</li>
<li><strong>prior_scatter</strong> (<em>optional, default = [25,0.1,0.1]</em>) &#8211; array giving the widths of the normal distributions from which to draw prior parameter values</li>
<li><strong>model</strong> (<em>optional, default = 'BTSettl2008'</em>) &#8211; <p>set of models to use (<code class="docutils literal"><span class="pre">set</span></code> and <code class="docutils literal"><span class="pre">model_set</span></code> do the same); options include:</p>
<ul>
<li><em>&#8216;BTSettl2008&#8217;</em>: model set with effective temperature of 400 to 2900 K, surface gravity of 3.5 to 5.5 and metallicity of -3.0 to 0.5
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012RSPTA.370.2765A">Allard et al. (2012)</a></li>
<li><em>&#8216;burrows06&#8217;</em>: model set with effective temperature of 700 to 2000 K, surface gravity of 4.5 to 5.5, metallicity of -0.5 to 0.5,
and sedimentation efficiency of either 0 or 100 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...640.1063B">Burrows et al. (2006)</a></li>
<li><em>&#8216;morley12&#8217;</em>: model set with effective temperature of 400 to 1300 K, surface gravity of 4.0 to 5.5, metallicity of 0.0
and sedimentation efficiency of 2 to 5 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...756..172M">Morley et al. (2012)</a></li>
<li><em>&#8216;morley14&#8217;</em>: model set with effective temperature of 200 to 450 K, surface gravity of 3.0 to 5.0, metallicity of 0.0
and sedimentation efficiency of 5 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...787...78M">Morley et al. (2014)</a></li>
<li><em>&#8216;saumon12&#8217;</em>: model set with effective temperature of 400 to 1500 K, surface gravity of 3.0 to 5.5 and metallicity of 0.0
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...750...74S">Saumon et al. (2012)</a></li>
<li><em>&#8216;drift&#8217;</em>: model set with effective temperature of 1700 to 3000 K, surface gravity of 5.0 to 5.5 and metallicity of -3.0 to 0.0
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011A%26A...529A..44W">Witte et al. (2011)</a></li>
</ul>
</li>
<li><strong>radius</strong> (<em>optional, default = False</em>) &#8211; set to True to calculate and returns radius of object [NOT CURRENT IMPLEMENTED]</li>
<li><strong>save</strong> (<em>optional, default = True</em>) &#8211; save interim results to a .dat file based on output filename</li>
<li><strong>output</strong> (<em>optional, default = None</em>) &#8211; base filename for output (<code class="docutils literal"><span class="pre">filename</span></code> and <code class="docutils literal"><span class="pre">outfile</span></code> do the same);
outputs will include (each can be set individually with associated keywords):
- <code class="docutils literal"><span class="pre">filename_iterative.dat</span></code>: interative saved data
- <code class="docutils literal"><span class="pre">filename_summary.txt</span></code>: summary of results
- <code class="docutils literal"><span class="pre">filename_corner.eps</span></code>: corner plot of parameters
- <code class="docutils literal"><span class="pre">filename_comparison.eps</span></code>: plot spectrum compared to best fit model</li>
<li><strong>plot_format</strong> &#8211; file type for diagnostic plots</li>
<li><strong>noprompt</strong> (<em>optional, default = False</em>) &#8211; don&#8217;t prompt user to continue of emcee run will be &gt; 10 minutes</li>
<li><strong>verbose</strong> (<em>optional, default = False</em>) &#8211; give lots of feedback</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>In addition, the parameters for <a class="reference external" href="api.html#splat.compareSpectra">compareSpectra</a>, <a href="#id98"><span class="problematic" id="id99">generateMask_</span></a>, <a href="#id100"><span class="problematic" id="id101">plotSpectrum_</span></a>; see SPLAT API for details.</p>
<dl class="docutils">
<dt>Note: modelfitEMCEE requires external packages:</dt>
<dd><ul class="first simple">
<li><code class="docutils literal"><span class="pre">emcee</span></code>: <a class="reference external" href="http://dan.iel.fm/emcee/current">http://dan.iel.fm/emcee/current</a></li>
</ul>
<p class="last">-<code class="docutils literal"><span class="pre">corner</span></code>: <a class="reference external" href="http://corner.readthedocs.io/en/latest">http://corner.readthedocs.io/en/latest</a></p>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spt</span><span class="p">,</span><span class="n">spt_e</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teff</span><span class="p">,</span><span class="n">teff_e</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToTeff</span><span class="p">(</span><span class="n">spt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">modelFitEMCEE</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="n">teff</span><span class="p">,</span><span class="n">g0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">fit_metallicity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>    <span class="o">&gt;&gt;&gt;</span>    <span class="n">nwalkers</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">nsamples</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;/Users/adam/test_modelfitEMCEE&#39;</span><span class="p">)</span>
<span class="go">    Estimated time to compute = 9228 seconds = 153.8 minutes = 2.56 hours = 0.11 days</span>
<span class="go">    Do you want to continue? [Y/n]:</span>
<span class="go">    Progress: [**************************************************]</span>
</pre></div>
</div>
<p>Results are saved in test_modelfitEMCEE_interative.dat, <a href="#id45"><span class="problematic" id="id46">*</span></a>_chains.pdf, <a href="#id47"><span class="problematic" id="id48">*</span></a>_comparison.pdf, <a href="#id49"><span class="problematic" id="id50">*</span></a>_corner.pdf, and <a href="#id51"><span class="problematic" id="id52">*</span></a>_summary.txt</p>
</dd></dl>

<dl class="function">
<dt id="splat_model.reportModelFitResults">
<code class="descclassname">splat_model.</code><code class="descname">reportModelFitResults</code><span class="sig-paren">(</span><em>spec</em>, <em>t</em>, <em>*arg</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_model.reportModelFitResults" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Reports the result of model fitting parameters. Produces triangle plot, best fit model, statistics of parameters and saves raw data if <code class="docutils literal"><span class="pre">iterative</span> <span class="pre">=</span> <span class="pre">True</span></code>.</td>
</tr>
</tbody>
</table>
<p>Required Inputs:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param spec:</th><td class="field-body">Spectrum class object, which should contain wave, flux and noise array elements.</td>
</tr>
<tr class="field-even field"><th class="field-name">param t:</th><td class="field-body">Must be an astropy Table with columns containing parameters fit, and one column for chi-square values (&#8216;chisqr&#8217;).</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="docutils">
<dt>Optional Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param evol:</th><td class="field-body">computes the mass, age, temperature, radius, surface gravity, and luminosity by using various evolutionary model sets. See below for the possible set options and the Brown Dwarf Evolutionary Models page for more details (default = True)</td>
</tr>
<tr class="field-even field"><th class="field-name">param emodel:</th><td class="field-body">set of evolutionary models to use; see <a class="reference external" href="api.html#splat_evolve.loadEvolModel">loadEvolModelParameters()</a> (default = &#8216;Baraffe&#8217;)</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param weight:</th><td class="field-body">set to True to use fitting statistic as a weighting to compute best fit statistics (default = True)</td>
</tr>
<tr class="field-even field"><th class="field-name">param stat:</th><td class="field-body">name of the statistics column in input table <code class="docutils literal"><span class="pre">t</span></code> (default = &#8216;chisqr&#8217;)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param stats:</th><td class="field-body">if True, prints several statistical values, including number of steps, best fit parameters, lowest chi2 value, median parameters and key values along the distribution (default = True)</td>
</tr>
<tr class="field-even field"><th class="field-name">param triangle:</th><td class="field-body">creates a triangle plot, plotting the parameters against each other, demonstrating areas of high and low chi squared values. Useful for demonstrating correlations between parameters (default = True)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param bestfit:</th><td class="field-body">set to True to plot best-fit model compared to spectrum (default=True)</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param model_set:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">desired model set of <code class="docutils literal"><span class="pre">bestfit</span></code>; see <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a> for allowed options (can also use &#8216;mset&#8217;; default = blank)</td>
</tr>
</tbody>
</table>
</div></blockquote>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param filebase:</th><td class="field-body">a string that is the base filename for output (default = &#8216;modelfit_results&#8217;)</td>
</tr>
<tr class="field-even field"><th class="field-name">param sigma:</th><td class="field-body">when printing statistical results (<code class="docutils literal"><span class="pre">stats</span></code> = True), print the value at <code class="docutils literal"><span class="pre">sigma</span></code> standard deviations away from the mean (default = 1)</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">param iterative:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">if True, prints quantitative results but does not plot anything (default = False)</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="docutils">
<dt>Output:</dt>
<dd>No formal output, but results are plotted to various files</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1047+2124&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>        <span class="c1"># T6.5 radio emitter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spt</span><span class="p">,</span> <span class="n">spt_e</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">spt</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">,</span><span class="s1">&#39;T8&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teff</span><span class="p">,</span><span class="n">teff_e</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToTeff</span><span class="p">(</span><span class="n">spt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;MKO J&#39;</span><span class="p">,</span><span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="n">spt</span><span class="p">,</span><span class="s1">&#39;MKO J&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">absolute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">modelFitMCMC</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">mask_standard</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">initial_guess</span><span class="o">=</span><span class="p">[</span><span class="n">teff</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">zstep</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">savestep</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">reportModelFitResults</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">evol</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">stats</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">triangle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">    Number of steps = 169</span>
<span class="go">    Best Fit parameters:</span>
<span class="go">    Lowest chi2 value = 29567.2136599 for 169.0 degrees of freedom</span>
<span class="go">    Effective Temperature = 918.641 (K)</span>
<span class="go">    log Surface Gravity = 5.211</span>
<span class="go">    Metallicity = 0.000</span>
<span class="go">    Radius (relative to Sun) from surface fluxes = 0.096</span>

<span class="go">    Median parameters:</span>
<span class="go">    Effective Temperature = 927.875 + 71.635 - 73.237 (K)</span>
<span class="go">    log Surface Gravity = 5.210 + 0.283 - 0.927</span>
<span class="go">    Metallicity = 0.000 + 0.000 - 0.000</span>
<span class="go">    Radius (relative to Sun) from surface fluxes = 0.108 + 0.015 - 0.013</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="evolutionary-model-routines">
<h3>Evolutionary Model Routines<a class="headerlink" href="#evolutionary-model-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat_evolve.loadEvolModel">
<code class="descclassname">splat_evolve.</code><code class="descname">loadEvolModel</code><span class="sig-paren">(</span><em>*model</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_evolve.loadEvolModel" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Reads in the evolutionary model parameters for the models listed below, which are used to interpolate parameters in <a class="reference external" href="api.html#splat_evolve.modelParameters">modelParameters()</a>.</td>
</tr>
</tbody>
</table>
<p>Available models are:</p>
<blockquote>
<div><ul>
<li><p class="first"><strong>burrows</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001RvMP...73..719B">Burrows et al. (2001)</a> for 1 Myr &lt; age &lt; 10 Gyr, 0.005 Msol &lt; mass &lt; 0.2 Msol, and solar metallicity</p>
</li>
<li><p class="first"><strong>baraffe</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/2003A&amp;A...402..701B">Baraffe et al. (2003)</a> for 1 Myr &lt; age &lt; 10 Gyr, 0.005 Msol &lt; mass &lt; 0.1 Msol, and solar metallicity (COND dust prescription)</p>
</li>
<li><p class="first"><strong>saumon</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...689.1327S">Saumon et al. (2003)</a> for 3 Myr &lt; age &lt; 10 Gyr, 0.002 Msol &lt; mass &lt; 0.085 Msol, although mass and age ranges vary as the maximum temperature for the models is 2500 K. For these models there are additional options:</p>
<blockquote>
<div><ul class="simple">
<li><strong>metallicity</strong> = <cite>solar</cite>, <cite>+0.3</cite>, or <cite>-0.3</cite></li>
<li><strong>cloud</strong> =  <cite>cloud-free</cite>, <cite>hybrid</cite>, <cite>f2</cite> (sub- and super-solar metallicities are only cloud-free)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>Parameter units (in astropy convention) are:</p>
<blockquote>
<div><ul class="simple">
<li><cite>masses</cite>: Solar masses</li>
<li><cite>ages</cite>: Gyr</li>
<li><cite>temperature</cite>: K</li>
<li><cite>gravity</cite>: log10 of cm/s/s</li>
<li><cite>luminosity</cite>: log10 of Solar luminosities</li>
<li><cite>radius</cite>: Solar radii</li>
</ul>
</div></blockquote>
<p>Models are contained in SPLAT&#8217;s reference/EvolutionaryModels folder.</p>
<p>Required Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">model: string of the name of the evolutionary model set to be used; can be <cite>baraffe</cite> (default), <cite>burrows</cite>, or <cite>saumon</cite></td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body"><p class="first">metallicity: for Saumon models, this is the metallicity assumed, and can be a string or integer.  Allowed values are 0 (or <cite>solar</cite> = default), -0.3 (or <cite>subsolar</cite>) or 0.3 (or <cite>supersolar</cite>)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body"><p class="first">cloud: for Saumon models, this is the desired cloud prescription, and is a string:</p>
<ul class="last simple">
<li>no clouds: <cite>cloud</cite> = <cite>nocloud</cite>, <cite>cloud-free</cite> or <cite>nc</cite> (default)</li>
<li>hybrid cloud prescription: <cite>cloud</cite> = <cite>hybrid</cite></li>
<li>f2 cloud prescription: <cite>cloud</cite> = <cite>f2</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Output:</p>
<p>Dictionary containing keywords mass, age, temperature, luminosity, gravity, and radius, each linked to the evolutionary parameters retrieved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">loadEvolModel</span><span class="p">(</span><span class="s1">&#39;saumon&#39;</span><span class="p">,</span><span class="n">metallicity</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">cloud</span><span class="o">=</span><span class="s1">&#39;nc&#39;</span><span class="p">)</span>
<span class="go">You are using saumon&#39;s models.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">12</span><span class="p">]))</span>
<span class="go">age: 0.15</span>
<span class="go">mass: [ 0.002  0.003  0.004  0.005  0.006  0.007  0.008  0.009  0.01   0.011</span>
<span class="go">  0.012  0.013  0.014  0.015  0.016  0.017  0.018  0.019  0.02   0.022</span>
<span class="go">  0.024  0.026  0.028  0.03   0.033  0.035  0.038  0.04   0.043  0.045</span>
<span class="go">  0.048  0.05   0.053]</span>
<span class="go">temperature: [  353.   418.   471.   523.   585.   642.   695.   748.   806.   893.</span>
<span class="go">  1146.  1228.  1114.  1113.  1148.  1183.  1227.  1270.  1316.  1402.</span>
<span class="go">  1489.  1572.  1654.  1739.  1853.  1930.  2030.  2096.  2187.  2240.</span>
<span class="go">  2316.  2362.  2426.]</span>
<span class="go">gravity: [ 3.576  3.746  3.871  3.972  4.056  4.128  4.191  4.246  4.296  4.335</span>
<span class="go">  4.337  4.368  4.437  4.479  4.512  4.543  4.571  4.597  4.621  4.665</span>
<span class="go">  4.704  4.74   4.772  4.8    4.839  4.861  4.892  4.909  4.931  4.947</span>
<span class="go">  4.966  4.978  4.996]</span>
<span class="go">luminosity: [-6.691 -6.393 -6.185 -6.006 -5.815 -5.658 -5.527 -5.404 -5.277 -5.098</span>
<span class="go"> -4.628 -4.505 -4.709 -4.724 -4.675 -4.627 -4.568 -4.51  -4.45  -4.342</span>
<span class="go"> -4.24  -4.146 -4.058 -3.969 -3.856 -3.781 -3.69  -3.628 -3.546 -3.5   -3.432</span>
<span class="go"> -3.393 -3.34 ]</span>
<span class="go">radius: [ 0.1206  0.1214  0.1214  0.1209  0.1202  0.1195  0.1189  0.1182  0.1178</span>
<span class="go">  0.1181  0.123   0.1235  0.1184  0.1167  0.1161  0.1154  0.1151  0.1148</span>
<span class="go">  0.1146  0.1142  0.1139  0.1139  0.1138  0.1141  0.1144  0.115   0.1155</span>
<span class="go">  0.1163  0.1174  0.118   0.1193  0.12    0.121 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_evolve.modelParameters">
<code class="descclassname">splat_evolve.</code><code class="descname">modelParameters</code><span class="sig-paren">(</span><em>*model</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_evolve.modelParameters" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Retrieves the evolutionary model parameters given two of the following parameters: mass, age, temperature, luminosity, gravity, or radius. The inputs can be individual values or arrays.  Using the input parameters, the associated evolutionary model parameters are computed through log-linear interpolation of the original model grid. Parameters that fall outside the grid return nan.</td>
</tr>
</tbody>
</table>
<p>Required Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">model: Either a string of the name of the evolutionary model set, which can be one of <cite>baraffe</cite> (default), <cite>burrows</cite>, or <cite>saumon</cite>; or a dictionary output from <a class="reference external" href="api.html#splat_evolve.loadEvolModel">loadEvolModel()</a> containing model parameters.</td>
</tr>
</tbody>
</table>
<p>and two (2) of the following:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">mass: input value of list of values for mass (can also be <cite>masses</cite> or <cite>m</cite>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">age: input value of list of values for age (can also be <cite>ages</cite>, <cite>time</cite> or <cite>a</cite>)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">temperature: input value of list of values for temperature (can also be <cite>temperatures</cite>, <cite>teff</cite>, <cite>temp</cite> or <cite>t</cite>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">gravity: input value of list of values for gravity (can also be <cite>gravities</cite>, <cite>grav</cite>, <cite>logg</cite> or <cite>g</cite>)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">luminosity: input value of list of values for luminosity (can also be <cite>luminosities</cite>, <cite>lum</cite>, <cite>lbol</cite> or <cite>l</cite>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">radius: input value of list of values for radius (can also be <cite>radii</cite>, <cite>rad</cite> and <cite>r</cite>)</td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">Parameters for <a class="reference external" href="api.html#splat_evolve.loadEvolModel">loadEvolModel()</a> may also be used.</td>
</tr>
</tbody>
</table>
<p>Output:</p>
<p>Dictionary containing keywords mass, age, temperature, luminosity, gravity, and radius, each linked to the evolutionary parameters retrieved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masses</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ages</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">modelParameters</span><span class="p">(</span><span class="s1">&#39;baraffe&#39;</span><span class="p">,</span><span class="n">mass</span><span class="o">=</span><span class="n">masses</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="n">ages</span><span class="p">)</span>
<span class="go">You are using baraffe&#39;s models.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
<span class="go">[ 2502.90132332  2818.85920306  1002.64227134  1330.37273021  1192.86976417</span>
<span class="go">  500.45609068  2604.99966013  1017.03307609  1774.18267474  1675.12181635</span>
<span class="go">  2682.9697321   2512.45223777   346.41152614  2066.19972036   843.28528456</span>
<span class="go">  2264.93051445  2767.85660557   348.84214986   922.87030167  2669.27152307] K</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_evolve.modelParametersSingle">
<code class="descclassname">splat_evolve.</code><code class="descname">modelParametersSingle</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_evolve.modelParametersSingle" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Driver function for <a href="#id102"><span class="problematic" id="id103">modelParameters_</span></a>, performs actual interpolation of evolutionary models. See SPLAT API for <a class="reference external" href="api.html#splat_evolve.modelParameters">modelParameters()</a> for details.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat_evolve.plotModelParameters">
<code class="descclassname">splat_evolve.</code><code class="descname">plotModelParameters</code><span class="sig-paren">(</span><em>parameters</em>, <em>xparam</em>, <em>yparam</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_evolve.plotModelParameters" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Plots pairs of physical star parameters and optionally compares to evolutionary model tracks.</td>
</tr>
</tbody>
</table>
<p>Required Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">parameters: dictionary or nested set of two arrays containing parameters to be plotted. For dictionary, keywords should include the <cite>xparameter</cite> and <cite>yparameter</cite> strings to be plotted. Values associated with keywords can be single numbers or arrays</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">xparam: string corresponding to the key in the <cite>parameters</cite> dictionary to be plot as the x (independent) variable.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">yparam: string corresponding to the key in the <cite>parameters</cite> dictionary to be plot as the y (dependent) variable.</td>
</tr>
</tbody>
</table>
<p>Optional Inputs:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">showmodel: set to True to overplot evolutionary model tracks from <cite>model</cite> (default = True)</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">model: either a string of the name of the evolutionary model set, one of  <cite>baraffe</cite> (default), <cite>burrows</cite>, or <cite>saumon</cite>; or a dictionary output from <a class="reference external" href="api.html#splat_evolve.loadEvolModel">loadEvolModel()</a> containing model parameters.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">tracks: string indicating what model tracks to show; can either be <cite>mass</cite> (default) or <cite>age</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">file: name of file to output plot (<cite>output</cite> can also be used)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">show: set to True to show the plot onscreen (default = True)</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">figsize: a two-element array defining the figure size (default = [8,6])</td>
</tr>
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">color: color of data symbols (default = &#8216;blue&#8217;)</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">marker: matplotlib marker type for data symbols (default = &#8216;o&#8217;)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">xlabel: string overriding the x-axis label (default = parameter name and unit)</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">ylabel: string overriding the y-axis label (default = parameter name and unit)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">title: string specifying plot title (no title by default)</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">tight: set to True to tighten plot to focus on the data points (default = True)</td>
</tr>
</tbody>
</table>
<p>Output:</p>
<p>A matplotlib plot object. Optionally, can also show plot on screen or output plot to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">age_samp</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mass_samp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">modelParameters</span><span class="p">(</span><span class="s1">&#39;baraffe&#39;</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="n">age_samp</span><span class="p">,</span><span class="n">mass</span><span class="o">=</span><span class="n">mass_samp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">plotModelParameters</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">showmodels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;baraffe&#39;</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[plot of temperature vs age for 50 data points with baraffe models overplotted]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="specialty-packages">
<h2>Specialty Packages<a class="headerlink" href="#specialty-packages" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euclid-analysis-routines">
<h3>EUCLID Analysis Routines<a class="headerlink" href="#euclid-analysis-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat_euclid.spexToEuclid">
<code class="descclassname">splat_euclid.</code><code class="descname">spexToEuclid</code><span class="sig-paren">(</span><em>sp</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_euclid.spexToEuclid" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Convert a SpeX file into EUCLID form, using the resolution and wavelength coverage
defined from the Euclid Red Book (<a class="reference external" href="http://sci.esa.int/euclid/48983-euclid-definition-study-report-esa-sre-2011-12/">Laurijs et al. 2011</a>). This function changes the input Spectrum
objects, which can be restored by the Spectrum.reset() method.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>                                <span class="c1"># grab a random file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">spexToEuclid</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">min</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">)</span>
<span class="go">         (&lt;Quantity 1.25 micron&gt;, &lt;Quantity 1.8493000000000364 micron&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">history</span>
<span class="go">         [``&#39;Spectrum successfully loaded``&#39;,</span>
<span class="go">          ``&#39;Converted to EUCLID format``&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">min</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">)</span>
<span class="go">         (&lt;Quantity 0.6454827785491943 micron&gt;, &lt;Quantity 2.555659770965576 micron&gt;)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="splat_euclid.addEuclidNoise">
<code class="descclassname">splat_euclid.</code><code class="descname">addEuclidNoise</code><span class="sig-paren">(</span><em>sp</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_euclid.addEuclidNoise" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body"><p class="first">Adds Gaussian noise to a EUCLID-formatted spectrum assuming a constant noise
model of 3e-15 erg/s/cm2/micron (as extrapolated from the Euclid Red Book;
Laurijs et al. 2011 &lt;<a class="reference external" href="http://sci.esa.int/euclid/48983-euclid-definition-study-report-esa-sre-2011-12/">http://sci.esa.int/euclid/48983-euclid-definition-study-report-esa-sre-2011-12/</a>&gt;`_).
Note that noise is added to both flux and (in quadrature) variance. This function creates a
new Spectrum object so as not to corrupt the original data.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sp</strong> &#8211; Spectrum class object, which should contain wave, flux and noise array elements</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><p class="first">Spectrum object with Euclid noise added in</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>                                <span class="c1"># grab a random file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">spexToEuclid</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e-14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">         115.96374031163553</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp_noisy</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">addEculidNoise</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp_noisy</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">         3.0847209519763172</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="bibtex-routines">
<h3>BibTeX Routines<a class="headerlink" href="#bibtex-routines" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat_db.getBibTex">
<code class="descclassname">splat_db.</code><code class="descname">getBibTex</code><span class="sig-paren">(</span><em>bibcode</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.getBibTex" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Purpose</dt>
<dd><dl class="first last docutils">
<dt>Takes a bibcode and returns a dictionary containing the bibtex information; looks either in internal SPLAT</dt>
<dd>or user-supplied bibfile, or seeks online. If nothing found, gives a soft warning and returns False</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Note:</th><td class="field-body"><p class="first"><strong>Currently not functional</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Required parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param bibcode:</th><td class="field-body">Bibcode string to look up (e.g., &#8216;2014ApJ...787..126L&#8217;)</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Optional parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param biblibrary:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">Filename for biblibrary to use in place of SPLAT internal one</td>
</tr>
<tr class="field-even field"><th class="field-name">type string:</th><td class="field-body">optional, default = &#8216;&#8217;</td>
</tr>
<tr class="field-odd field"><th class="field-name">param online:</th><td class="field-body">If True, go directly online; if False, do not try to go online</td>
</tr>
<tr class="field-even field"><th class="field-name">type logical:</th><td class="field-body">optional, default = null</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Output:</th><td class="field-body"><ul class="first last simple">
<li>A dictionary containing the bibtex fields, or False if not found</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="astroquery-based-data-access">
<h3>Astroquery-based Data Access<a class="headerlink" href="#astroquery-based-data-access" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="splat_db.getPhotometry">
<code class="descclassname">splat_db.</code><code class="descname">getPhotometry</code><span class="sig-paren">(</span><em>coordinate</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.getPhotometry" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Purpose</dt>
<dd>Downloads photometry for a source by coordinate using astroquery</dd>
<dt>Required Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">coordinate: Either an astropy SkyCoord or a variable that can be converted into a SkyCoord using <a class="reference external" href="api.html#splat.properCoordinates">splat.properCoordinates()</a></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="docutils">
<dt>Optional Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param radius:</th><td class="field-body">Search radius, nominally in arcseconds although this can be changed by passing an astropy.unit quantity (default = 30 arcseconds)</td>
</tr>
<tr class="field-even field"><th class="field-name">param catalog:</th><td class="field-body">Catalog to query, which can be set to the Vizier catalog identifier code or to one of the following preset catalogs:
* &#8216;2MASS&#8217; (or set <a href="#id57"><span class="problematic" id="id58">``</span></a>2MASS``=True): the 2MASS All-Sky Catalog of Point Sources (<a class="reference external" href="http://adsabs.harvard.edu/abs/2003yCat.2246....0C">Cutri et al. 2003</a>), Vizier id II/246
* &#8216;SDSS&#8217; (or set <a href="#id59"><span class="problematic" id="id60">``</span></a>SDSS``=True): the The SDSS Photometric Catalog, Release 9 (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJS..203...21A">Adelman-McCarthy et al. 2012</a>), Vizier id V/139
* &#8216;WISE&#8217; (or set <a href="#id61"><span class="problematic" id="id62">``</span></a>WISE``=True): the WISE All-Sky Data Release (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012yCat.2311....0C">Cutri et al. 2012</a>), Vizier id II/311
* &#8216;ALLWISE&#8217; (or set <a href="#id63"><span class="problematic" id="id64">``</span></a>ALLWISE``=True): the AllWISE Data Release (<a class="reference external" href="http://adsabs.harvard.edu/abs/2014yCat.2328....0C">Cutri et al. 2014</a>), Vizier id II/328
* &#8216;VISTA&#8217; (or set <a href="#id65"><span class="problematic" id="id66">``</span></a>VISTA``=True): the VIKING catalogue data release 1 (<a class="reference external" href="http://adsabs.harvard.edu/abs/2013Msngr.154...32E">Edge et al. 2013</a>), Vizier id II/329
* &#8216;CFHTLAS&#8217; (or set <a href="#id67"><span class="problematic" id="id68">``</span></a>CFHTLAS``=True): the CFHTLS Survey (T0007 release) by (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012yCat.2317....0H">Hudelot et al. 2012</a>), Vizier id II/317
* &#8216;DENIS&#8217; (or set <a href="#id69"><span class="problematic" id="id70">``</span></a>DENIS``=True): the DENIS DR3 (DENIS Consortium 2005), Vizier id B/denis/denis
* &#8216;UKIDSS&#8217; (or set <a href="#id71"><span class="problematic" id="id72">``</span></a>UKIDSS``=True): the UKIDSS-DR8 LAS, GCS and DXS Surveys (<a class="reference external" href="http://adsabs.harvard.edu/abs/2007MNRAS.379.1599L">Lawrence et al. 2012</a>), Vizier id II/314
* &#8216;LEHPM&#8217; (or set <a href="#id73"><span class="problematic" id="id74">``</span></a>LEHPM``=True): the Liverpool-Edinburgh High Proper Motion Catalogue (<a class="reference external" href="http://adsabs.harvard.edu/abs/2004A&amp;A...421..763P">Pokorny et al. 2004</a>), Vizier id J/A+A/421/763
* &#8216;SIPS&#8217; (or set <a href="#id75"><span class="problematic" id="id76">``</span></a>SIPS``=True): the Southern Infrared Proper Motion Survey (<a class="reference external" href="http://adsabs.harvard.edu/abs/2005A&amp;A...435..363D">Deacon et al 2005</a>), Vizier id J/A+A/435/363
* &#8216;UCAC4&#8217; (or set <a href="#id77"><span class="problematic" id="id78">``</span></a>UCAC4``=True): the UCAC4 Catalogue (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012yCat.1322....0Z">Zacharias et al. 2012</a>), Vizier id I/322A
* &#8216;USNOB&#8217; (or set <a href="#id79"><span class="problematic" id="id80">``</span></a>USNO``=True): the USNO-B1.0 Catalog (<a class="reference external" href="http://adsabs.harvard.edu/abs/2003AJ....125..984M">Monet et al. 2003</a>), Vizier id I/284
* &#8216;LSPM&#8217; (or set <a href="#id81"><span class="problematic" id="id82">``</span></a>LSPM``=True): the LSPM-North Catalog (<a class="reference external" href="http://adsabs.harvard.edu/abs/2005AJ....129.1483L">Lepine et al. 2005</a>), Vizier id I/298
* &#8216;GAIA&#8217; (or set <a href="#id83"><span class="problematic" id="id84">``</span></a>GAIA``=True): the GAIA DR1 Catalog (<a class="reference external" href="http://adsabs.harvard.edu/abs/2016yCat.1337....0G">Gaia Collaboration et al. 2016</a>), Vizier id I/337</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">sort: String specifying the parameter to sort the returned SIMBAD table by; by default this is the offset from the input coordinate (default = &#8216;sep&#8217;)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body">nearest: Set to True to return on the single nearest source to coordinate (default = False)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">verbose: Give feedback (default = False)</td>
</tr>
</tbody>
</table>
</dd>
<dt>Output:</dt>
<dd>An astropy Table instance that contains data from the Vizier query, or a blank Table if no sources are found</dd>
</dl>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J053625-064302&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">querySimbad</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">catalog</span><span class="o">=</span><span class="s1">&#39;SDSS&#39;</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">15.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">  _r    _RAJ2000   _DEJ2000  mode q_mode  cl ... r_E_ g_J_ r_F_ i_N_  sep</span>
<span class="go"> arcs     deg        deg                     ... mag  mag  mag  mag   arcs</span>
<span class="go">------ ---------- ---------- ---- ------ --- ... ---- ---- ---- ---- ------</span>
<span class="go"> 7.860  84.105967  -6.715966    1          3 ...   --   --   --   --  7.860</span>
<span class="go">14.088  84.108113  -6.717206    1          6 ...   --   --   --   -- 14.088</span>
<span class="go">14.283  84.102528  -6.720843    1      +   6 ...   --   --   --   -- 14.283</span>
<span class="go">16.784  84.099524  -6.717878    1          3 ...   --   --   --   -- 16.784</span>
<span class="go">22.309  84.097988  -6.718049    1      +   6 ...   --   --   --   -- 22.309</span>
<span class="go">23.843  84.100079  -6.711999    1      +   6 ...   --   --   --   -- 23.843</span>
<span class="go">27.022  84.107504  -6.723965    1      +   3 ...   --   --   --   -- 27.022</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="splat_db.querySimbad">
<code class="descclassname">splat_db.</code><code class="descname">querySimbad</code><span class="sig-paren">(</span><em>variable</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#splat_db.querySimbad" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Purpose</dt>
<dd>Queries Simbad using astroquery to grab information about a source</dd>
<dt>Required Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">variable: Either an astropy SkyCoord object containing position of a source, a variable that can be converted into a SkyCoord using <a class="reference external" href="api.html#splat.properCoordinates">splat.properCoordinates()</a>, or a string name for a source.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="docutils">
<dt>Optional Inputs:</dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">radius: Search radius, nominally in arcseconds although can be set by assigning and astropy.unit value (default = 30 arcseconds)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body">sort: String specifying the parameter to sort the returned SIMBAD table by; by default this is the offset from the input coordinate (default = &#8216;sep&#8217;)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">reject_type: Set to string or list of strings to filter out object types not desired. Useful for crowded fields (default = None)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body">nearest: Set to True to return on the single nearest source to coordinate (default = False)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">iscoordinate: Specifies that input is a coordinate of some kind (default = False)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body">isname: Specifies that input is a name of some kind (default = False)</td>
</tr>
<tr class="field-odd field"><th class="field-name">param:</th><td class="field-body">clean: Set to True to clean the SIMBAD output and reassign to a predefined set of parameters (default = True)</td>
</tr>
<tr class="field-even field"><th class="field-name">param:</th><td class="field-body">verbose: Give lots of feedback (default = False)</td>
</tr>
</tbody>
</table>
</dd>
<dt>Output:</dt>
<dd>An astropy Table instance that contains data from the SIMBAD search, or a blank Table if no sources found</dd>
</dl>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J053625-064302&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">querySimbad</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">15.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span><span class="n">reject_type</span><span class="o">=</span><span class="s1">&#39;**&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">          NAME          OBJECT_TYPE     OFFSET    ... K_2MASS K_2MASS_E</span>
<span class="go">----------------------- ----------- ------------- ... ------- ---------</span>
<span class="go">           BD-06  1253B        Star  4.8443894429 ...</span>
<span class="go">            [SST2010] 3        Star 5.74624887682 ...   18.36       0.1</span>
<span class="go">            BD-06  1253         Ae* 7.74205447776 ...   5.947     0.024</span>
<span class="go">           BD-06  1253A          ** 7.75783861347 ...</span>
<span class="go">2MASS J05362590-0643020     brownD* 13.4818185612 ...  12.772     0.026</span>
<span class="go">2MASS J05362577-0642541        Star  13.983717577 ...</span>
</pre></div>
</div>
</dd></dl>

<p><em>Search</em></p>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="splat_evolve.html" class="btn btn-neutral" title="Brown Dwarf Evolutionary Models" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Adam Burgasser.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5.dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>